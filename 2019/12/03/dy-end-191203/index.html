<!DOCTYPE html>
<html lang=zh>
<head><meta name="generator" content="Hexo 3.8.0">
    <!-- so meta -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <meta name="description" content="正文先分析个if块，对应的c++伪代码如下1234567891011121314151617181920212223if ( paramsArray )                            // 如果String[]不为null&amp;#123;  pArrayLength = _JNIEnv::GetArrayLength(env, paramsArray);// 获取Strin">
<meta name="keywords" content="android,reverse engineering,python,dy,ida">
<meta property="og:type" content="article">
<meta property="og:title" content="5a6J5Y2T5oqW6Z+z55+t6KeG6aKRdjHlroznu5M=">
<meta property="og:url" content="http://zckun.github.io/2019/12/03/dy-end-191203/index.html">
<meta property="og:site_name" content="0x2h">
<meta property="og:description" content="正文先分析个if块，对应的c++伪代码如下1234567891011121314151617181920212223if ( paramsArray )                            // 如果String[]不为null&amp;#123;  pArrayLength = _JNIEnv::GetArrayLength(env, paramsArray);// 获取Strin">
<meta property="og:locale" content="zh-Hans">
<meta property="og:image" content="http://2h0n9.com:40302/2019/12/03/dy-end-191203/images/main.jpg">
<meta property="og:image" content="http://zckun.github.io/2019/12/03/dy-end-191203/images/idapro_new_instance.png">
<meta property="og:image" content="http://zckun.github.io/2019/12/03/dy-end-191203/images/find_app.png">
<meta property="og:image" content="http://zckun.github.io/2019/12/03/dy-end-191203/images/app_dbgsrc.png">
<meta property="og:image" content="http://zckun.github.io/2019/12/03/dy-end-191203/images/idapro_debugger_attach_remote_android_debugger.png">
<meta property="og:image" content="http://zckun.github.io/2019/12/03/dy-end-191203/images/idapro_debugger_setup.png">
<meta property="og:image" content="http://zckun.github.io/2019/12/03/dy-end-191203/images/idapro_debugger_attach.png">
<meta property="og:image" content="http://zckun.github.io/2019/12/03/dy-end-191203/images/idapro_debugger_attach_find.png">
<meta property="og:image" content="http://zckun.github.io/2019/12/03/dy-end-191203/images/idapro_debugger_main.png">
<meta property="og:image" content="http://zckun.github.io/2019/12/03/dy-end-191203/images/idapro_debugger_segment.png">
<meta property="og:image" content="http://zckun.github.io/2019/12/03/dy-end-191203/images/idapro_debugger_segment_find.png">
<meta property="og:image" content="http://zckun.github.io/2019/12/03/dy-end-191203/images/idapro_debugger_3E384_jump.png">
<meta property="og:image" content="http://zckun.github.io/2019/12/03/dy-end-191203/images/idapro_debugger_dcb_to_asm.png">
<meta property="og:image" content="http://zckun.github.io/2019/12/03/dy-end-191203/images/idapro_debugger_3E384_breakpoint.png">
<meta property="og:image" content="http://zckun.github.io/2019/12/03/dy-end-191203/images/breakpoint.png">
<meta property="og:image" content="http://zckun.github.io/2019/12/03/dy-end-191203/images/registers.png">
<meta property="og:image" content="http://zckun.github.io/2019/12/03/dy-end-191203/images/dissembly_offset_4_addr.png">
<meta property="og:image" content="http://zckun.github.io/2019/12/03/dy-end-191203/images/operator-_01.png">
<meta property="og:image" content="http://zckun.github.io/2019/12/03/dy-end-191203/images/operator-_02.png">
<meta property="og:updated_time" content="2019-12-03T05:47:27.304Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="5a6J5Y2T5oqW6Z+z55+t6KeG6aKRdjHlroznu5M=">
<meta name="twitter:description" content="正文先分析个if块，对应的c++伪代码如下1234567891011121314151617181920212223if ( paramsArray )                            // 如果String[]不为null&amp;#123;  pArrayLength = _JNIEnv::GetArrayLength(env, paramsArray);// 获取Strin">
<meta name="twitter:image" content="http://2h0n9.com:40302/2019/12/03/dy-end-191203/images/main.jpg">
    
    
        
          
              <link rel="shortcut icon" href="/images/favicon.ico">
          
        
        
          
            <link rel="icon" type="image/png" href="/images/favicon-192x192.png" sizes="192x192">
          
        
        
          
            <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">
          
        
    
    <!-- title -->
    <title>5a6J5Y2T5oqW6Z+z55+t6KeG6aKRdjHlroznu5M=</title>
    <!-- styles -->
    <link rel="stylesheet" href="/css/style.css">
    <!-- persian styles -->
    
      <link rel="stylesheet" href="/css/rtl.css">
    
    <!-- rss -->
    
    
</head>

<body class="max-width mx-auto px3 ltr">
    
      <div id="header-post">
  <a id="menu-icon" href="#"><i class="fas fa-bars fa-lg"></i></a>
  <a id="menu-icon-tablet" href="#"><i class="fas fa-bars fa-lg"></i></a>
  <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fas fa-chevron-up fa-lg"></i></a>
  <span id="menu">
    <span id="nav">
      <ul>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="/about/">About</a></li>
         
          <li><a href="/archives/">Writing</a></li>
         
          <li><a href="/projects_url">Projects</a></li>
        
      </ul>
    </span>
    <br>
    <span id="actions">
      <ul>
        
        <li><a class="icon" href="/2019/12/21/radara-plus-frida-equals-r2friad-191221/"><i class="fas fa-chevron-left" aria-hidden="true" onmouseover="$('#i-prev').toggle();" onmouseout="$('#i-prev').toggle();"></i></a></li>
        
        
        <li><a class="icon" href="/2019/11/11/douyin-native-getname-analysis-191111/"><i class="fas fa-chevron-right" aria-hidden="true" onmouseover="$('#i-next').toggle();" onmouseout="$('#i-next').toggle();"></i></a></li>
        
        <li><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fas fa-chevron-up" aria-hidden="true" onmouseover="$('#i-top').toggle();" onmouseout="$('#i-top').toggle();"></i></a></li>
        <li><a class="icon" href="#"><i class="fas fa-share-alt" aria-hidden="true" onmouseover="$('#i-share').toggle();" onmouseout="$('#i-share').toggle();" onclick="$('#share').toggle();return false;"></i></a></li>
      </ul>
      <span id="i-prev" class="info" style="display:none;">Previous post</span>
      <span id="i-next" class="info" style="display:none;">Next post</span>
      <span id="i-top" class="info" style="display:none;">Back to top</span>
      <span id="i-share" class="info" style="display:none;">Share post</span>
    </span>
    <br>
    <div id="share" style="display: none">
      <ul>
  <li><a class="icon" href="http://www.facebook.com/sharer.php?u=http://zckun.github.io/2019/12/03/dy-end-191203/"><i class="fab fa-facebook " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://twitter.com/share?url=http://zckun.github.io/2019/12/03/dy-end-191203/&text=5a6J5Y2T5oqW6Z+z55+t6KeG6aKRdjHlroznu5M="><i class="fab fa-twitter " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.linkedin.com/shareArticle?url=http://zckun.github.io/2019/12/03/dy-end-191203/&title=5a6J5Y2T5oqW6Z+z55+t6KeG6aKRdjHlroznu5M="><i class="fab fa-linkedin " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=http://zckun.github.io/2019/12/03/dy-end-191203/&is_video=false&description=5a6J5Y2T5oqW6Z+z55+t6KeG6aKRdjHlroznu5M="><i class="fab fa-pinterest " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=5a6J5Y2T5oqW6Z+z55+t6KeG6aKRdjHlroznu5M=&body=Check out this article: http://zckun.github.io/2019/12/03/dy-end-191203/"><i class="fas fa-envelope " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://getpocket.com/save?url=http://zckun.github.io/2019/12/03/dy-end-191203/&title=5a6J5Y2T5oqW6Z+z55+t6KeG6aKRdjHlroznu5M="><i class="fab fa-get-pocket " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://reddit.com/submit?url=http://zckun.github.io/2019/12/03/dy-end-191203/&title=5a6J5Y2T5oqW6Z+z55+t6KeG6aKRdjHlroznu5M="><i class="fab fa-reddit " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.stumbleupon.com/submit?url=http://zckun.github.io/2019/12/03/dy-end-191203/&title=5a6J5Y2T5oqW6Z+z55+t6KeG6aKRdjHlroznu5M="><i class="fab fa-stumbleupon " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://digg.com/submit?url=http://zckun.github.io/2019/12/03/dy-end-191203/&title=5a6J5Y2T5oqW6Z+z55+t6KeG6aKRdjHlroznu5M="><i class="fab fa-digg " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.tumblr.com/share/link?url=http://zckun.github.io/2019/12/03/dy-end-191203/&name=5a6J5Y2T5oqW6Z+z55+t6KeG6aKRdjHlroznu5M=&description="><i class="fab fa-tumblr " aria-hidden="true"></i></a></li>
</ul>

    </div>
    <div id="toc">
      <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#正文"><span class="toc-number">1.</span> <span class="toc-text">正文</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#IDA调试"><span class="toc-number">2.</span> <span class="toc-text">IDA调试</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#最后"><span class="toc-number">3.</span> <span class="toc-text">最后</span></a></li></ol>
    </div>
  </span>
</div>

    
    <div class="content index py4">
        
        <article class="post" itemscope="" itemtype="http://schema.org/BlogPosting">
  <header>
    
    <h1 class="posttitle" itemprop="name headline">
        5a6J5Y2T5oqW6Z+z55+t6KeG6aKRdjHlroznu5M=
    </h1>



    <div class="meta">
      <span class="author" itemprop="author" itemscope="" itemtype="http://schema.org/Person">
        <span itemprop="name">0x2h</span>
      </span>
      
    <div class="postdate">
      
        <time datetime="2019-12-02T17:21:49.000Z" itemprop="datePublished">2019-12-03</time>
        
      
    </div>


      

      
    <div class="article-tag">
        <i class="fas fa-tag"></i>
        <a class="tag-link" href="/tags/android/">android</a>, <a class="tag-link" href="/tags/dy/">dy</a>, <a class="tag-link" href="/tags/ida/">ida</a>, <a class="tag-link" href="/tags/python/">python</a>, <a class="tag-link" href="/tags/reverse-engineering/">reverse engineering</a>
    </div>


    </div>
  </header>
  

  <div class="content" itemprop="articleBody">
    <p><img src="http://2h0n9.com:40302/2019/12/03/dy-end-191203/images/main.jpg" alt=""></p>
<hr>
<h2 id="正文"><a href="#正文" class="headerlink" title="正文"></a>正文</h2><p>先分析个<code>if</code>块，对应的c++伪代码如下<br><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> ( paramsArray )                            <span class="comment">// 如果String[]不为null</span></span><br><span class="line">&#123;</span><br><span class="line">  pArrayLength = _JNIEnv::GetArrayLength(env, paramsArray);<span class="comment">// 获取String[]长度</span></span><br><span class="line">  <span class="keyword">if</span> ( !(pArrayLength &amp; <span class="number">1</span>) )                  <span class="comment">// 这里是判断String[]长度是不是2的倍数，目的应该是为了判断参数是否完整</span></span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">for</span> ( j = <span class="number">0</span>; j &lt; pArrayLength; j += <span class="number">2</span> )   <span class="comment">// 以2为间隔遍历String[]，其实就是为了获取key，因为key肯定在前面的，例如：0 2 4 6 8 10 都是key的索引</span></span><br><span class="line">    &#123;</span><br><span class="line">      key = _JNIEnv::GetObjectArrayElement((<span class="keyword">int</span>)env, (<span class="keyword">int</span>)paramsArray, j);<span class="comment">// GetObjectArrayElement这个方法是获取array元素，第一个参数是jnienv，参数二是array，参数三是索引</span></span><br><span class="line">      key_char = (<span class="keyword">const</span> <span class="keyword">char</span> *)_JNIEnv::GetStringUTFChars((<span class="keyword">int</span>)env, key, <span class="number">0</span>);<span class="comment">// 将array元素转为字符串</span></span><br><span class="line">      value = _JNIEnv::GetObjectArrayElement((<span class="keyword">int</span>)env, (<span class="keyword">int</span>)paramsArray, j + <span class="number">1</span>);<span class="comment">// 这个就是获取value了</span></span><br><span class="line">      v38_value = getUTF8(env, (<span class="keyword">int</span>)jcls, value);<span class="comment">// 转为字符串</span></span><br><span class="line">      nullsub_1();</span><br><span class="line">      sub_3FCC8(&amp;v46, key_char, (<span class="keyword">int</span>)&amp;v45);   <span class="comment">// 首先处理key，v45为key_char长度</span></span><br><span class="line">      v18 = <span class="built_in">std</span>::<span class="built_in">map</span>&lt;<span class="built_in">std</span>::<span class="built_in">string</span>,<span class="built_in">std</span>::<span class="built_in">string</span>,<span class="built_in">std</span>::less&lt;<span class="built_in">std</span>::<span class="built_in">string</span>&gt;,<span class="built_in">std</span>::allocator&lt;<span class="built_in">std</span>::pair&lt;<span class="built_in">std</span>::<span class="built_in">string</span> <span class="keyword">const</span>,<span class="built_in">std</span>::<span class="built_in">string</span>&gt;&gt;&gt;::<span class="keyword">operator</span>[](</span><br><span class="line">              (<span class="keyword">int</span>)&amp;v47,</span><br><span class="line">              (<span class="keyword">int</span>)&amp;v46);                     <span class="comment">// 将处理后的key添加到map</span></span><br><span class="line">      sub_3F044(v18, v38_value, v19, v18);    <span class="comment">// 接着处理value</span></span><br><span class="line">      sub_3EAE8(&amp;v46);</span><br><span class="line">      nullsub_2();</span><br><span class="line">      _JNIEnv::ReleaseStringUTFChars(env, key, key_char);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>注释因为是很久以前写的了，仅供参考。<br>map这玩意儿类似 <code>Java 中的 map</code> 和 <code>python 中的 dict</code>，不过底层是啥玩意儿我就不太清楚，没怎么学过c++。<br>这里的逻辑应该看得明白：</p>
<blockquote>
<p>1、首先是判断paramsArray，也就是请求参数被分割成的字符串数组。这个字符串数据的<strong><code>索引%2(0,2,...)</code></strong>是key。所以这个array差不多是这个形式：<code>[key,value,key,value,...]</code><br>2、然后就是 if 判断参数数组是否完整<br>3、接着就是遍历字符串数组，按键值对的形式保存到map对象里</p>
</blockquote>
<p>挑几条代码分析一波</p>
<blockquote>
<p>这里是调用了jni的<code>GetObjectArrayElement</code>方法获取数组元素，第一个参数是<code>java接口指针</code>，第二参数是<code>jobjectArray数组</code>，第三个参数是<code>索引</code>。分别获取key和value<br><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">key = _JNIEnv::GetObjectArrayElement((<span class="keyword">int</span>)env, (<span class="keyword">int</span>)paramsArray, j);</span><br><span class="line">value = _JNIEnv::GetObjectArrayElement((<span class="keyword">int</span>)env, (<span class="keyword">int</span>)paramsArray, j + <span class="number">1</span>);</span><br></pre></td></tr></table></figure></p>
</blockquote>
<blockquote>
<p>然后呢，v47是map类型的。首先是operator[]方法，这个方法<code>返回到映射到等于 key 的关键的值的引用，若这种关键不存在则进行插入</code> <a href="http://www.cplusplus.com/reference/map/map/operator[]/" target="_blank" rel="noopener"><strong>?</strong></a>，意思就是用key取value，就好比python里的dict取值一样：<code>params[&#39;key&#39;]</code>。至于3F044这个地址的方法是干嘛的我就懒得去了解了，只要大概知道做了些什么就行。<br><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">v18 = <span class="built_in">std</span>::<span class="built_in">map</span>&lt;<span class="built_in">std</span>::<span class="built_in">string</span>,<span class="built_in">std</span>::<span class="built_in">string</span>,<span class="built_in">std</span>::less&lt;<span class="built_in">std</span>::<span class="built_in">string</span>&gt;,<span class="built_in">std</span>::allocator&lt;<span class="built_in">std</span>::pair&lt;<span class="built_in">std</span>::<span class="built_in">string</span> <span class="keyword">const</span>,<span class="built_in">std</span>::<span class="built_in">string</span>&gt;&gt;&gt;::<span class="keyword">operator</span>[](</span><br><span class="line">                (<span class="keyword">int</span>)&amp;v47,</span><br><span class="line">                (<span class="keyword">int</span>)&amp;v46);</span><br><span class="line">sub_3F044(v18, v38_value, v19, v18);</span><br></pre></td></tr></table></figure></p>
</blockquote>
<hr>
<p>后面还有几行也一并分析了<br><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">v41 = &amp;v47;</span><br><span class="line">v45 = <span class="built_in">std</span>::<span class="built_in">map</span>&lt;<span class="built_in">std</span>::<span class="built_in">string</span>,<span class="built_in">std</span>::<span class="built_in">string</span>,<span class="built_in">std</span>::less&lt;<span class="built_in">std</span>::<span class="built_in">string</span>&gt;,<span class="built_in">std</span>::allocator&lt;<span class="built_in">std</span>::pair&lt;<span class="built_in">std</span>::<span class="built_in">string</span> <span class="keyword">const</span>,<span class="built_in">std</span>::<span class="built_in">string</span>&gt;&gt;&gt;::begin(&amp;v47);<span class="comment">// 获取map首个iterate</span></span><br><span class="line">v46 = <span class="built_in">std</span>::<span class="built_in">map</span>&lt;<span class="built_in">std</span>::<span class="built_in">string</span>,<span class="built_in">std</span>::<span class="built_in">string</span>,<span class="built_in">std</span>::less&lt;<span class="built_in">std</span>::<span class="built_in">string</span>&gt;,<span class="built_in">std</span>::allocator&lt;<span class="built_in">std</span>::pair&lt;<span class="built_in">std</span>::<span class="built_in">string</span> <span class="keyword">const</span>,<span class="built_in">std</span>::<span class="built_in">string</span>&gt;&gt;&gt;::end(v41);<span class="comment">// 获取map最后一个iterate</span></span><br><span class="line"><span class="keyword">while</span> ( <span class="built_in">std</span>::_Rb_tree_iterator&lt;<span class="built_in">std</span>::pair&lt;<span class="built_in">std</span>::<span class="built_in">string</span> <span class="keyword">const</span>,<span class="built_in">std</span>::<span class="built_in">string</span>&gt;&gt;::<span class="keyword">operator</span>!=(&amp;v45, &amp;v46) )<span class="comment">// 如果首尾不相等就一直循环</span></span><br><span class="line">&#123;</span><br><span class="line">v42 = <span class="built_in">std</span>::_Rb_tree_iterator&lt;<span class="built_in">std</span>::pair&lt;<span class="built_in">std</span>::<span class="built_in">string</span> <span class="keyword">const</span>,<span class="built_in">std</span>::<span class="built_in">string</span>&gt;&gt;::<span class="keyword">operator</span>*(&amp;v45);</span><br><span class="line">sub_3F36C((<span class="keyword">int</span>)&amp;v32, v42 + <span class="number">4</span>);              <span class="comment">// 字符串拼接</span></span><br><span class="line"><span class="built_in">std</span>::_Rb_tree_iterator&lt;<span class="built_in">std</span>::pair&lt;<span class="built_in">std</span>::<span class="built_in">string</span> <span class="keyword">const</span>,<span class="built_in">std</span>::<span class="built_in">string</span>&gt;&gt;::<span class="keyword">operator</span>++(&amp;v45);</span><br><span class="line">&#125;</span><br><span class="line">v20 = sub_3EC48(&amp;v32);</span><br><span class="line">v21 = sub_3EC80(&amp;v32);</span><br><span class="line">sub_153C0(v20, v21, v6);</span><br><span class="line">v22 = (<span class="keyword">char</span> *)sub_3E4D4((<span class="keyword">int</span>)&amp;v32);</span><br></pre></td></tr></table></figure></p>
<p>也是挑选几行分析</p>
<blockquote>
<p>1、这两行是获取map的开头和结尾两个迭代器<br><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">v45 = <span class="built_in">std</span>::<span class="built_in">map</span>&lt;<span class="built_in">std</span>::<span class="built_in">string</span>,<span class="built_in">std</span>::<span class="built_in">string</span>,<span class="built_in">std</span>::less&lt;<span class="built_in">std</span>::<span class="built_in">string</span>&gt;,<span class="built_in">std</span>::allocator&lt;<span class="built_in">std</span>::pair&lt;<span class="built_in">std</span>::<span class="built_in">string</span> <span class="keyword">const</span>,<span class="built_in">std</span>::<span class="built_in">string</span>&gt;&gt;&gt;::begin(&amp;v47);</span><br><span class="line">v46 = <span class="built_in">std</span>::<span class="built_in">map</span>&lt;<span class="built_in">std</span>::<span class="built_in">string</span>,<span class="built_in">std</span>::<span class="built_in">string</span>,<span class="built_in">std</span>::less&lt;<span class="built_in">std</span>::<span class="built_in">string</span>&gt;,<span class="built_in">std</span>::allocator&lt;<span class="built_in">std</span>::pair&lt;<span class="built_in">std</span>::<span class="built_in">string</span> <span class="keyword">const</span>,<span class="built_in">std</span>::<span class="built_in">string</span>&gt;&gt;&gt;::end(v41);</span><br></pre></td></tr></table></figure></p>
</blockquote>
<blockquote>
<p>2、然后呢。先是一层while循环，条件是v45和v46不相等就一直循环<br><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">while</span> ( <span class="built_in">std</span>::_Rb_tree_iterator&lt;<span class="built_in">std</span>::pair&lt;<span class="built_in">std</span>::<span class="built_in">string</span> <span class="keyword">const</span>,<span class="built_in">std</span>::<span class="built_in">string</span>&gt;&gt;::<span class="keyword">operator</span>!=(&amp;v45, &amp;v46) )<span class="comment">// 如果不相等就一直循环</span></span><br><span class="line">&#123;</span><br><span class="line">v42 = <span class="built_in">std</span>::_Rb_tree_iterator&lt;<span class="built_in">std</span>::pair&lt;<span class="built_in">std</span>::<span class="built_in">string</span> <span class="keyword">const</span>,<span class="built_in">std</span>::<span class="built_in">string</span>&gt;&gt;::<span class="keyword">operator</span>*(&amp;v45);</span><br><span class="line">sub_3F36C((<span class="keyword">int</span>)&amp;v32, v42 + <span class="number">4</span>);              <span class="comment">// 字符串拼接</span></span><br><span class="line"><span class="built_in">std</span>::_Rb_tree_iterator&lt;<span class="built_in">std</span>::pair&lt;<span class="built_in">std</span>::<span class="built_in">string</span> <span class="keyword">const</span>,<span class="built_in">std</span>::<span class="built_in">string</span>&gt;&gt;::<span class="keyword">operator</span>++(&amp;v45);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
</blockquote>
<blockquote>
<p>循环内部首先是从map开头迭代器中获取key的name，然后用获取到的name的地址偏移4个字节获取到下一个key的name。以上仅仅是我个人的分析，所以为了验证，直接调试。为了方便我直接把我以前写的调试教程贴上来了</p>
</blockquote>
<hr>
<h2 id="IDA调试"><a href="#IDA调试" class="headerlink" title="IDA调试"></a>IDA调试</h2><p>点 File -&gt; New instance(新建实例) 新打开一个程序，大概长这样</p>
<p><img src="images/idapro_new_instance.png" alt=""></p>
<p>然后点 GO，这个时候我们还需要做一件事，直接调试是不可能的，需要一个中介人一样的东西，和frida-server差不多的东西，一般都在ida安装文件夹里，我这里目前只有mac，所以只说mac，找到你的app</p>
<p><img src="images/find_app.png" alt=""></p>
<p>然后右键显示包内容，路径是 Contents/MacOS/dbgsrc/ </p>
<p><img src="images/app_dbgsrc.png" alt=""></p>
<p>这里面有两个 android_server 一个是32位一个是64位，这里用32位就行，把它复制到你手机根目录的文件夹里，但也别乱放，我放在data里，命令如下：<br><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">adb push android_server /data/ # 复制</span><br><span class="line">adb shell # 进入交互</span><br><span class="line"><span class="meta">$</span> su # 拿个权限</span><br><span class="line"><span class="meta">#</span> chmod +x /data/android_server # 给个执行权限</span><br><span class="line"><span class="meta">#</span> /data/android_server # 启动</span><br><span class="line">IDA Android 32-bit remote debug server(ST) v1.22. Hex-Rays (c) 2004-2017</span><br><span class="line">Listening on 0.0.0.0:23946...</span><br><span class="line">=========================================================</span><br><span class="line">[1] Accepting connection from 127.0.0.1...</span><br><span class="line">[1] Closing connection from 127.0.0.1...</span><br><span class="line">=========================================================</span><br><span class="line">[2] Accepting connection from 127.0.0.1...</span><br><span class="line">[2] Closing connection from 127.0.0.1...</span><br></pre></td></tr></table></figure></p>
<p>输出了大概这么些东西就差不多了，其中23946是端口，复制一下；然后新开一个terminal，转发一下端口：<br><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">adb forward tcp:23946 tcp:23946</span><br></pre></td></tr></table></figure></p>
<p>接着回到ida，在菜单栏处点 Debugger -&gt; attach 选择 Remote ARMLinux/Android Debugger 调试类型</p>
<p><img src="images/idapro_debugger_attach_remote_android_debugger.png" alt=""></p>
<p>在新弹出的窗口里点确定就行，如果你要改什么的话就点 options</p>
<p><img src="images/idapro_debugger_setup.png" alt=""></p>
<p>不出意外的话你将会看到这个进程窗口，如果出意外的话我也没办法，大家都这么大了自己google</p>
<p><img src="images/idapro_debugger_attach.png" alt=""></p>
<p>按 Ctrl-F mac也是这个快捷键，输入 com.ss 就会筛选处抖音进程，前提是你打开了抖音，出现这个窗口后你没打开，然后你打开了你就需要右键 Refresh 刷新再搜索，找到之后双击或者点 OK 开始debug，这里需要注意，如果你手机一直出现未响应弹窗记得要一直点等待，不然ida会崩，然后你就要重新来过</p>
<p><img src="images/idapro_debugger_attach_find.png" alt=""></p>
<p>然后就进入了调试界面，这时候程序是卡着的，别乱点手机了</p>
<p><img src="images/idapro_debugger_main.png" alt=""></p>
<p>第一步先加载 libuserinfo.so 找到基址，按 Ctrl-S 打开选择段跳转窗口</p>
<p><img src="images/idapro_debugger_segment.png" alt=""></p>
<p>还是 ctrl-f 搜索，start 是开始，也就是起始地址，这就是基址</p>
<p><img src="images/idapro_debugger_segment_find.png" alt=""></p>
<p>接着回到之前分析的ida，复制那个方法地址 0x3E384，用基址加这个得到方法在内存中的地址 0xcef08384，按 G 跳转到这地方</p>
<p><img src="images/idapro_debugger_3E384_jump.png" alt=""></p>
<p><img src="images/idapro_debugger_dcb_to_asm.png" alt=""></p>
<p>在这方法开头处按 F2 打个断点，然后 F9 运行  </p>
<p><img src="images/idapro_debugger_3E384_breakpoint.png" alt=""></p>
<p>这时候可以刷新一下让程序执行到这 … emm 接着我调试了一会儿后发现这玩意儿好像没什么用，权当讲了下怎么调试吧，接着分析</p>
<hr>
<p>我在执行后将返回值复制到r3寄存器处和sub_3f36c函数调用结束后下一条指令处分别下了一个断点<br><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">v42 = <span class="built_in">std</span>::_Rb_tree_iterator&lt;<span class="built_in">std</span>::pair&lt;<span class="built_in">std</span>::<span class="built_in">string</span> <span class="keyword">const</span>,<span class="built_in">std</span>::<span class="built_in">string</span>&gt;&gt;::<span class="keyword">operator</span>*(&amp;v45);</span><br></pre></td></tr></table></figure></p>
<p><img src="images/breakpoint.png" alt=""></p>
<p>打好断点后，直接运行，运行到指令 <code>ADD             R2, SP, #0x90+var_78</code> 处，此时的寄存器如下图</p>
<p><img src="images/registers.png" alt=""></p>
<p>首先可以从上图看到，r3寄存器的地址正好是r0寄存器的地址偏移4个字节的地址，这两个地址的内容如下图</p>
<p><img src="images/dissembly_offset_4_addr.png" alt=""></p>
<hr>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sub_3F36C((<span class="keyword">int</span>)&amp;v32, v42 + <span class="number">4</span>);</span><br></pre></td></tr></table></figure>
<p>使用下面的frida hook代码可以得知该方法为字符串拼接</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">String</span>.prototype.format = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> values = <span class="built_in">arguments</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">this</span>.replace(<span class="regexp">/\&#123;(\d+)\&#125;/g</span>, <span class="function"><span class="keyword">function</span> (<span class="params">match, index</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (values.length &gt; index) &#123;</span><br><span class="line">            <span class="keyword">return</span> values[index];</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="string">""</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// Memory.readUtf8String</span></span><br><span class="line"><span class="keyword">var</span> mru8s = <span class="function"><span class="keyword">function</span>(<span class="params">addr</span>) </span>&#123;<span class="keyword">return</span> Memory.readUtf8String(addr)&#125;</span><br><span class="line"><span class="comment">// Memory.readPointer</span></span><br><span class="line"><span class="keyword">var</span> mrp = <span class="function"><span class="keyword">function</span>(<span class="params">addr</span>) </span>&#123;<span class="keyword">return</span> Memory.readPointer(addr)&#125;</span><br><span class="line"><span class="comment">// Memory.allocUtf8String</span></span><br><span class="line"><span class="keyword">var</span> mau8s = <span class="function"><span class="keyword">function</span>(<span class="params">addr</span>) </span>&#123;<span class="keyword">return</span> Memory.allocUtf8String(addr)&#125;</span><br><span class="line"><span class="comment">// read process memory</span></span><br><span class="line"><span class="keyword">var</span> rpm = <span class="function"><span class="keyword">function</span>(<span class="params">addr, size</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> buf = Memory.readByteArray(ptr(<span class="string">'0x'</span> + addr), size);</span><br><span class="line">    <span class="built_in">console</span>.log(hexdump(buf, &#123;</span><br><span class="line">    offset: <span class="number">0</span>,</span><br><span class="line">        length: size,</span><br><span class="line">        header: <span class="literal">true</span>,</span><br><span class="line">        ansi: <span class="literal">false</span></span><br><span class="line">    &#125;));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//==================================================================</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> JNI_OnLoad;</span><br><span class="line"><span class="keyword">var</span> exports = Module.enumerateExportsSync(<span class="string">"libuserinfo.so"</span>);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; exports.length; i++) &#123;</span><br><span class="line">    <span class="keyword">var</span> name = exports[i].name;</span><br><span class="line">    <span class="keyword">var</span> addr = exports[i].address;</span><br><span class="line">    <span class="keyword">if</span> (name == <span class="string">'JNI_OnLoad'</span>) &#123;</span><br><span class="line">        JNI_OnLoad = addr;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> BASE_ADDR = <span class="built_in">parseInt</span>(JNI_OnLoad) - <span class="built_in">parseInt</span>(<span class="string">"0x14504"</span>);</span><br><span class="line"><span class="keyword">var</span> addr = <span class="string">'0x'</span> + <span class="built_in">parseInt</span>(BASE_ADDR + <span class="built_in">parseInt</span>(<span class="string">'0x3F36C'</span>)).toString(<span class="number">16</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> i = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">Interceptor.attach(<span class="keyword">new</span> NativePointer(addr), &#123;</span><br><span class="line">    onEnter: <span class="function"><span class="keyword">function</span>(<span class="params">args</span>) </span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">'&#123;0&#125;======================='</span>.format(addr));</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">'[&#123;0&#125;](&#123;1&#125;)(&#123;2&#125;) 参数1 &gt; &#123;3&#125;\n'</span>.format(args[<span class="number">0</span>],</span><br><span class="line">                                                    mrp(args[<span class="number">0</span>]),</span><br><span class="line">                                                    mrp(mrp(args[<span class="number">0</span>])),</span><br><span class="line">                                                    mru8s(mrp(args[<span class="number">0</span>]))));</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">'[&#123;0&#125;](&#123;1&#125;) 参数2 &gt; &#123;2&#125;\n'</span>.format(args[<span class="number">1</span>],</span><br><span class="line">                                                      mrp(args[<span class="number">1</span>]),</span><br><span class="line">                                                      mru8s(mrp(args[<span class="number">1</span>]))));</span><br><span class="line">    &#125;,</span><br><span class="line">    onLeave: <span class="function"><span class="keyword">function</span>(<span class="params">retval</span>) </span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">'retval &gt; '</span>, retval);</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">'\n'</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>然后是空格和’+’字符替换操作<br><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">v20 = sub_3EC48(&amp;v32);</span><br><span class="line">v21 = sub_3EC80(&amp;v32);</span><br><span class="line">sub_153C0(v20, v21, v6);</span><br></pre></td></tr></table></figure></p>
<p>主要看 <code>153C0</code> 这个方法，v20是拼接后的字符串，v21正常情况下为空，v6这个是一个char，没用到。<br>下面是 <code>153C0</code> 的伪代码<br><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> __<span class="function">fastcall <span class="title">sub_153C0</span><span class="params">(<span class="keyword">int</span> a1, <span class="keyword">int</span> a2, <span class="keyword">char</span> a3)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">int</span> v3; <span class="comment">// r4</span></span><br><span class="line">  _BYTE *v4; <span class="comment">// r0</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">while</span> ( __gnu_cxx::<span class="keyword">operator</span>!=&lt;<span class="keyword">char</span> *,<span class="built_in">std</span>::<span class="built_in">string</span>&gt;((<span class="keyword">int</span>)&amp;a1, (<span class="keyword">int</span>)&amp;a2) )</span><br><span class="line">  &#123;</span><br><span class="line"></span><br><span class="line">    v4 = (_BYTE *)__gnu_cxx::__normal_iterator&lt;<span class="keyword">char</span> *,<span class="built_in">std</span>::<span class="built_in">string</span>&gt;::<span class="keyword">operator</span>*(&amp;a1);</span><br><span class="line">    sub_13EE8((<span class="keyword">int</span>)&amp;a3, v4);                    <span class="comment">// 将字符串中的空格和+替换为字符a</span></span><br><span class="line">    __gnu_cxx::__normal_iterator&lt;<span class="keyword">char</span> *,<span class="built_in">std</span>::<span class="built_in">string</span>&gt;::<span class="keyword">operator</span>++(&amp;a1);</span><br><span class="line">  &#125;</span><br><span class="line">  sub_153B4();</span><br><span class="line">  <span class="keyword">return</span> v3;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>operator!=那里可以这样写：<code>a1 != a2</code>；然后循环体首先取a1的第一个字符给v4，接着调用sub_13EE8，就是替换’ ‘ 和 ‘+’ 字符为字符 ‘a’<br><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">void</span> __<span class="function">fastcall <span class="title">sub_13EE8</span><span class="params">(<span class="keyword">int</span> a1, _BYTE *a2)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">if</span> ( *a2 == <span class="number">32</span> || *a2 == <span class="number">43</span> )                 <span class="comment">// 如果a2等于' '或'+'，那么返回a</span></span><br><span class="line">    *a2 = <span class="number">97</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>从伪代码中看不到返回值是什么，切换到汇编<br><figure class="highlight arm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="symbol">.text</span>:<span class="number">000153</span><span class="built_in">C0</span> <span class="number">10</span> <span class="keyword">B5 </span>      <span class="keyword">PUSH </span>           &#123;<span class="built_in">R4</span>,<span class="built_in">LR</span>&#125;</span><br><span class="line"><span class="symbol">.text</span>:<span class="number">000153</span><span class="built_in">C2</span> <span class="number">84</span> <span class="keyword">B0 </span>      <span class="keyword">SUB </span>            <span class="built_in">SP</span>, <span class="built_in">SP</span>, <span class="number">#0x10</span></span><br><span class="line"><span class="symbol">.text</span>:<span class="number">000153</span><span class="built_in">C4</span> <span class="number">03</span> <span class="number">90</span>       <span class="keyword">STR </span>            <span class="built_in">R0</span>, [<span class="built_in">SP</span>,<span class="number">#0x18</span>+var_C]</span><br><span class="line"><span class="symbol">.text</span>:<span class="number">000153</span><span class="built_in">C6</span> <span class="number">02</span> <span class="number">91</span>       <span class="keyword">STR </span>            <span class="built_in">R1</span>, [<span class="built_in">SP</span>,<span class="number">#0x18</span>+var_10]</span><br><span class="line"><span class="symbol">.text</span>:<span class="number">000153</span><span class="built_in">C8</span> <span class="number">8</span>D F8 <span class="number">04</span> <span class="number">20</span> <span class="keyword">STRB.W </span>         <span class="built_in">R2</span>, [<span class="built_in">SP</span>,<span class="number">#0x18</span>+var_14]</span><br><span class="line"><span class="symbol">.text</span>:<span class="number">000153</span>CC <span class="number">0</span>D E0       <span class="keyword">B </span>              loc_153EA</span><br></pre></td></tr></table></figure></p>
<blockquote>
<p>push，把R4寄存器和LR寄存器放到堆栈里，其中R4为方法<code>3EC48</code>的返回值<br>然后把参数1、2、3也依次放到堆栈里</p>
</blockquote>
<p>接着是while循环体。</p>
<figure class="highlight arm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="symbol">.text</span>:<span class="number">000153</span>EA             loc_153EA</span><br><span class="line"><span class="symbol">.text</span>:<span class="number">000153</span>EA <span class="number">03</span> AA       <span class="keyword">ADD </span>            <span class="built_in">R2</span>, <span class="built_in">SP</span>, <span class="number">#0x18</span>+var_C</span><br><span class="line"><span class="symbol">.text</span>:<span class="number">000153</span>EC <span class="number">02</span> AB       <span class="keyword">ADD </span>            <span class="built_in">R3</span>, <span class="built_in">SP</span>, <span class="number">#0x18</span>+var_10</span><br><span class="line"><span class="symbol">.text</span>:<span class="number">000153</span>EE <span class="number">10</span> <span class="number">46</span>       <span class="keyword">MOV </span>            <span class="built_in">R0</span>, <span class="built_in">R2</span></span><br><span class="line"><span class="symbol">.text</span>:<span class="number">000153</span><span class="built_in">F0</span> <span class="number">19</span> <span class="number">46</span>       <span class="keyword">MOV </span>            <span class="built_in">R1</span>, <span class="built_in">R3</span></span><br><span class="line"><span class="symbol">.text</span>:<span class="number">000153</span><span class="built_in">F2</span> <span class="number">00</span> <span class="built_in">F0</span> <span class="number">7</span>D F9 <span class="keyword">BL </span>             _ZN9__gnu_cxxneIPcSsEEbRKNS_17__normal_iteratorIT_T0_EES7_ <span class="comment">; __gnu_cxx::operator!=&lt;char *,std::string&gt;(__gnu_cxx::__normal_iterator&lt;char *,std::string&gt; const&amp;,__gnu_cxx::__normal_iterator&lt;char *,std::string&gt; const&amp;)</span></span><br><span class="line"><span class="symbol">.text</span>:<span class="number">000153</span><span class="built_in">F6</span> <span class="number">03</span> <span class="number">46</span>       <span class="keyword">MOV </span>            <span class="built_in">R3</span>, <span class="built_in">R0</span></span><br><span class="line"><span class="symbol">.text</span>:<span class="number">000153</span>F8 <span class="number">00</span> <span class="number">2</span>B       <span class="keyword">CMP </span>            <span class="built_in">R3</span>, <span class="number">#0</span></span><br><span class="line"><span class="symbol">.text</span>:<span class="number">000153</span>FA E8 <span class="built_in">D1</span>       <span class="keyword">BNE </span>            loc_153CE</span><br></pre></td></tr></table></figure>
<blockquote>
<p><strong><code>000153EA&gt;</code></strong> 首先是从堆栈中取出参数1放到R2寄存器；然后取出参数2放到寄存器R3<br><strong><code>000153EE&gt;</code></strong> 然后把R2复制到R0，R3复制到R1<br><strong><code>000153F2&gt;</code></strong> 接着比较这两个寄存器中地址指向的内容是否相等，如果相等返回1，不想等返回0<br><strong><code>000153F6&gt;</code></strong> 结果复制到R3寄存器<br><strong><code>000153F8&gt;</code></strong> 然后比较如果等于0跳转到loc_153CE</p>
</blockquote>
<p>看true执行块<br><figure class="highlight arm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">0153</span>CE             loc_153CE</span><br><span class="line"><span class="symbol">.text</span>:<span class="number">000153</span>CE <span class="number">03</span> AB       <span class="keyword">ADD </span>            <span class="built_in">R3</span>, <span class="built_in">SP</span>, <span class="number">#0x18</span>+var_C</span><br><span class="line"><span class="symbol">.text</span>:<span class="number">000153</span><span class="built_in">D0</span> <span class="number">18</span> <span class="number">46</span>       <span class="keyword">MOV </span>            <span class="built_in">R0</span>, <span class="built_in">R3</span></span><br><span class="line"><span class="symbol">.text</span>:<span class="number">000153</span><span class="built_in">D2</span> <span class="number">00</span> <span class="built_in">F0</span> AF F9 <span class="keyword">BL </span>             _ZNK9__gnu_cxx17__normal_iteratorIPcSsEdeEv <span class="comment">; __gnu_cxx::__normal_iterator&lt;char *,std::string&gt;::operator*(void)</span></span><br><span class="line"><span class="symbol">.text</span>:<span class="number">000153</span><span class="built_in">D6</span>             <span class="comment">; 9:     sub_13EE8((int)&amp;a3, v4);                    // 将字符串中的空格和+替换为字符a</span></span><br><span class="line"><span class="symbol">.text</span>:<span class="number">000153</span><span class="built_in">D6</span> <span class="number">03</span> <span class="number">46</span>       <span class="keyword">MOV </span>            <span class="built_in">R3</span>, <span class="built_in">R0</span></span><br><span class="line"><span class="symbol">.text</span>:<span class="number">000153</span><span class="built_in">D8</span> <span class="number">01</span> AA       <span class="keyword">ADD </span>            <span class="built_in">R2</span>, <span class="built_in">SP</span>, <span class="number">#0x18</span>+var_14</span><br><span class="line"><span class="symbol">.text</span>:<span class="number">000153</span>DA <span class="number">10</span> <span class="number">46</span>       <span class="keyword">MOV </span>            <span class="built_in">R0</span>, <span class="built_in">R2</span></span><br><span class="line"><span class="symbol">.text</span>:<span class="number">000153</span>DC <span class="number">19</span> <span class="number">46</span>       <span class="keyword">MOV </span>            <span class="built_in">R1</span>, <span class="built_in">R3</span></span><br><span class="line"><span class="symbol">.text</span>:<span class="number">000153</span>DE FE <span class="built_in">F7</span> <span class="number">83</span> FD <span class="keyword">BL </span>             <span class="keyword">sub_13EE8</span></span><br><span class="line"><span class="keyword">.text:000153E2 </span>            <span class="comment">; 10:     __gnu_cxx::__normal_iterator&lt;char *,std::string&gt;::operator++(&amp;a1);</span></span><br><span class="line"><span class="symbol">.text</span>:<span class="number">000153</span>E2 <span class="number">03</span> AB       <span class="keyword">ADD </span>            <span class="built_in">R3</span>, <span class="built_in">SP</span>, <span class="number">#0x18</span>+var_C</span><br><span class="line"><span class="symbol">.text</span>:<span class="number">000153</span>E4 <span class="number">18</span> <span class="number">46</span>       <span class="keyword">MOV </span>            <span class="built_in">R0</span>, <span class="built_in">R3</span></span><br><span class="line"><span class="symbol">.text</span>:<span class="number">000153</span>E6 <span class="number">00</span> <span class="built_in">F0</span> <span class="number">99</span> F9 <span class="keyword">BL </span>             _ZN9__gnu_cxx17__normal_iteratorIPcSsEppEv <span class="comment">; __gnu_cxx::__normal_iterator&lt;char *,std::string&gt;::operator++</span></span><br></pre></td></tr></table></figure></p>
<blockquote>
<p><strong><code>000153CE&gt;</code></strong> 从堆栈取参数1到R3寄存器，然后复制到R0寄存器<br><strong><code>000153D2&gt;</code></strong> 然后是operator*方法，这个方法可以详细分析下它的汇编来搞懂是干嘛用的</p>
<blockquote>
<p>这是对应的汇编代码<br><figure class="highlight arm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="symbol">.text</span>:<span class="number">00015734</span>             var_4= -<span class="number">4</span></span><br><span class="line"><span class="symbol">.text</span>:<span class="number">00015734</span></span><br><span class="line"><span class="symbol">.text</span>:<span class="number">00015734</span> <span class="number">82</span> <span class="keyword">B0 </span>      <span class="keyword">SUB </span>            <span class="built_in">SP</span>, <span class="built_in">SP</span>, <span class="number">#8</span></span><br><span class="line"><span class="symbol">.text</span>:<span class="number">00015736</span> <span class="number">01</span> <span class="number">90</span>       <span class="keyword">STR </span>            <span class="built_in">R0</span>, [<span class="built_in">SP</span>,<span class="number">#8</span>+var_4]</span><br><span class="line"><span class="symbol">.text</span>:<span class="number">00015738</span> <span class="number">01</span> <span class="number">9</span>B       <span class="keyword">LDR </span>            <span class="built_in">R3</span>, [<span class="built_in">SP</span>,<span class="number">#8</span>+var_4]</span><br><span class="line"><span class="symbol">.text</span>:<span class="number">0001573</span>A <span class="number">1</span>B <span class="number">68</span>       <span class="keyword">LDR </span>            <span class="built_in">R3</span>, [<span class="built_in">R3</span>]</span><br><span class="line"><span class="symbol">.text</span>:<span class="number">0001573</span>C <span class="number">18</span> <span class="number">46</span>       <span class="keyword">MOV </span>            <span class="built_in">R0</span>, <span class="built_in">R3</span></span><br><span class="line"><span class="symbol">.text</span>:<span class="number">0001573</span>E <span class="number">02</span> <span class="keyword">B0 </span>      <span class="keyword">ADD </span>            <span class="built_in">SP</span>, <span class="built_in">SP</span>, <span class="number">#8</span></span><br><span class="line"><span class="symbol">.text</span>:<span class="number">00015740</span> <span class="number">70</span> <span class="number">47</span>       <span class="keyword">BX </span>             <span class="built_in">LR</span></span><br><span class="line"><span class="symbol">.text</span>:<span class="number">00015740</span>             <span class="comment">; End of function __gnu_cxx::__normal_iterator&lt;char *,std::string&gt;::operator*(void)</span></span><br><span class="line">&gt; &gt;</span><br></pre></td></tr></table></figure></p>
</blockquote>
</blockquote>
<blockquote>
<blockquote>
<p>为了更好的示范，我获取了该方法在内存中的地址<code>0xd5aab735</code>；并在内存中创建了一个字符串 “hello”，地址为 <code>0x9ef86a88</code></p>
</blockquote>
</blockquote>
<blockquote>
<blockquote>
<p>首先是在堆栈申请内存，然后将参数1放到刚刚申请的堆栈里，我画了个图<br><img src="images/operator-_01.png" alt=""><br>接着从 <code>SP+4</code> 处取出参数1的地址到R3，然后再从该地址取出存放的内容（hello）<br><img src="images/operator-_02.png" alt=""><br>然后将R3复制到R0，之后算是释放刚刚申请的堆栈内存，然后回到调用方法</p>
</blockquote>
</blockquote>
<blockquote>
<p><strong><code>000153D6&gt;</code></strong> 返回值放到R3寄存器<br><strong><code>000153D8&gt;</code></strong> 然后从堆栈取出第三个参数，放到R0寄存器；顺便把operator*的返回值放到R1寄存器，接着调用 <code>sub_13EE8</code> 方法，其中R0、R1为该方法的参数1和参数2；<br><code>sub_13EE8</code> 这个方法是替换’ ‘ 和 ‘+’ 为字符 ‘a’，就不分析了，看看伪代码就能懂<br><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">void</span> __<span class="function">fastcall <span class="title">sub_13EE8</span><span class="params">(<span class="keyword">int</span> a1, _BYTE *a2)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">if</span> ( *a2 == <span class="number">32</span> || *a2 == <span class="number">43</span> )                 <span class="comment">// 如果a2等于' '或'+'，那么返回a</span></span><br><span class="line">    *a2 = <span class="number">97</span>;</span><br><span class="line">&#125;</span><br><span class="line">&gt;</span><br></pre></td></tr></table></figure></p>
</blockquote>
<blockquote>
<p><strong><code>000153E2&gt;</code></strong> 这三条指令主要分析下<code>_ZN9__gnu_cxx17__normal_iteratorIPcSsEppEv</code><br>假设R0是字符串“Hello”</p>
<blockquote>
<figure class="highlight arm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="symbol">.text</span>:<span class="number">0001571</span>C <span class="number">82</span> <span class="keyword">B0 </span>      <span class="keyword">SUB </span>            <span class="built_in">SP</span>, <span class="built_in">SP</span>, <span class="number">#8</span></span><br><span class="line"><span class="symbol">.text</span>:<span class="number">0001571</span>E <span class="number">01</span> <span class="number">90</span>       <span class="keyword">STR </span>            <span class="built_in">R0</span>, [<span class="built_in">SP</span>,<span class="number">#8</span>+var_4]</span><br><span class="line"><span class="symbol">.text</span>:<span class="number">00015720</span> <span class="number">01</span> <span class="number">9</span>B       <span class="keyword">LDR </span>            <span class="built_in">R3</span>, [<span class="built_in">SP</span>,<span class="number">#8</span>+var_4]</span><br><span class="line"><span class="symbol">.text</span>:<span class="number">00015722</span> <span class="number">1</span>B <span class="number">68</span>       <span class="keyword">LDR </span>            <span class="built_in">R3</span>, [<span class="built_in">R3</span>]</span><br><span class="line"><span class="symbol">.text</span>:<span class="number">00015724</span> <span class="number">5</span>A <span class="number">1</span>C       <span class="keyword">ADDS </span>           <span class="built_in">R2</span>, <span class="built_in">R3</span>, <span class="number">#1</span></span><br><span class="line"><span class="symbol">.text</span>:<span class="number">00015726</span> <span class="number">01</span> <span class="number">9</span>B       <span class="keyword">LDR </span>            <span class="built_in">R3</span>, [<span class="built_in">SP</span>,<span class="number">#8</span>+var_4]</span><br><span class="line"><span class="symbol">.text</span>:<span class="number">00015728</span> <span class="number">1</span>A <span class="number">60</span>       <span class="keyword">STR </span>            <span class="built_in">R2</span>, [<span class="built_in">R3</span>]</span><br><span class="line"><span class="symbol">.text</span>:<span class="number">0001572</span>A <span class="number">01</span> <span class="number">9</span>B       <span class="keyword">LDR </span>            <span class="built_in">R3</span>, [<span class="built_in">SP</span>,<span class="number">#8</span>+var_4]</span><br><span class="line"><span class="symbol">.text</span>:<span class="number">0001572</span>C <span class="number">18</span> <span class="number">46</span>       <span class="keyword">MOV </span>            <span class="built_in">R0</span>, <span class="built_in">R3</span></span><br><span class="line"><span class="symbol">.text</span>:<span class="number">0001572</span>E <span class="number">02</span> <span class="keyword">B0 </span>      <span class="keyword">ADD </span>            <span class="built_in">SP</span>, <span class="built_in">SP</span>, <span class="number">#8</span></span><br><span class="line"><span class="symbol">.text</span>:<span class="number">00015730</span> <span class="number">70</span> <span class="number">47</span>       <span class="keyword">BX </span>             <span class="built_in">LR</span></span><br><span class="line">&gt; &gt;</span><br></pre></td></tr></table></figure>
</blockquote>
</blockquote>
<blockquote>
<blockquote>
<p>先是在堆栈分配内存<br>然后将R0放到堆栈<br>从堆栈取出字符串地址到R3<br>取出字符串到R3，此时R3的内容是十六进制格式的字符串<code>Hell</code>，也就是<code>0x6c6c6548</code><br>然后将<code>R3 + 1</code>后放到R2寄存器，所以R2为<code>0x6c6c6549</code><br>然后从堆栈重新取一次原字符串地址，将R2也就是+1后的字符串0x6c6c6549放到原字符串地址，然后复制到R0，接着就是释放堆栈并返回</p>
</blockquote>
</blockquote>
<blockquote>
<figure class="highlight arm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="symbol">.text</span>:<span class="number">000153</span>FC <span class="number">01</span> AB       <span class="keyword">ADD </span>            <span class="built_in">R3</span>, <span class="built_in">SP</span>, <span class="number">#0x18</span>+var_14</span><br><span class="line"><span class="symbol">.text</span>:<span class="number">000153</span>FE <span class="number">18</span> <span class="number">46</span>       <span class="keyword">MOV </span>            <span class="built_in">R0</span>, <span class="built_in">R3</span></span><br><span class="line"><span class="symbol">.text</span>:<span class="number">00015400</span> FF <span class="built_in">F7</span> <span class="built_in">D8</span> FF <span class="keyword">BL </span>             <span class="keyword">sub_153B4</span></span><br><span class="line"><span class="keyword">.text:00015404 </span><span class="number">23</span> <span class="number">46</span>       <span class="keyword">MOV </span>            <span class="built_in">R3</span>, <span class="built_in">R4</span></span><br><span class="line"><span class="symbol">.text</span>:<span class="number">00015406</span> <span class="number">18</span> <span class="number">46</span>       <span class="keyword">MOV </span>            <span class="built_in">R0</span>, <span class="built_in">R3</span></span><br><span class="line"><span class="symbol">.text</span>:<span class="number">00015408</span> <span class="number">04</span> <span class="keyword">B0 </span>      <span class="keyword">ADD </span>            <span class="built_in">SP</span>, <span class="built_in">SP</span>, <span class="number">#0x10</span></span><br><span class="line"><span class="symbol">.text</span>:<span class="number">0001540</span>A <span class="number">10</span> <span class="keyword">BD </span>      <span class="keyword">POP </span>            &#123;<span class="built_in">R4</span>,<span class="built_in">PC</span>&#125;</span><br><span class="line">&gt;</span><br></pre></td></tr></table></figure>
</blockquote>
<blockquote>
<p><strong><code>000153FC&gt;</code></strong> 取参数3到R3，然后复制到R0作为参数传入 <code>sub_153B4</code>，这个方法自己看看吧<br><strong><code>00015404&gt;</code></strong> 然后将R4复制到R3，又将R3复制到R0当作返回值，直接结束了<br>这个R4寄存器全程只见过三次，第一次是将它放到堆栈，第二次是复制到R3寄存器，第三次是pop。这个寄存器其实和这个方法的第一个参数也就是寄存器R0指向同一个地址，它是方法 <code>sub_3ec48</code> 的返回值，详细可以看到地址 <code>0001421C</code> 处<br><figure class="highlight arm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="symbol">.text</span>:<span class="number">00014218</span> <span class="number">2</span>A <span class="built_in">F0</span> <span class="number">16</span> FD <span class="keyword">BL </span>             <span class="keyword">sub_3EC48</span></span><br><span class="line"><span class="keyword">.text:0001421C </span><span class="number">04</span> <span class="number">46</span>       <span class="keyword">MOV </span>            <span class="built_in">R4</span>, <span class="built_in">R0</span></span><br><span class="line"><span class="symbol">.text</span>:<span class="number">0001421</span>E <span class="number">06</span> AB       <span class="keyword">ADD </span>            <span class="built_in">R3</span>, <span class="built_in">SP</span>, <span class="number">#0x90</span>+var_78</span><br><span class="line"><span class="symbol">.text</span>:<span class="number">00014220</span> <span class="number">18</span> <span class="number">46</span>       <span class="keyword">MOV </span>            <span class="built_in">R0</span>, <span class="built_in">R3</span></span><br><span class="line"><span class="symbol">.text</span>:<span class="number">00014222</span> <span class="number">2</span>A <span class="built_in">F0</span> <span class="number">2</span>D FD <span class="keyword">BL </span>             <span class="keyword">sub_3EC80</span></span><br><span class="line"><span class="keyword">.text:00014226 </span><span class="number">03</span> <span class="number">46</span>       <span class="keyword">MOV </span>            <span class="built_in">R3</span>, <span class="built_in">R0</span></span><br><span class="line"><span class="symbol">.text</span>:<span class="number">00014228</span> <span class="number">20</span> <span class="number">46</span>       <span class="keyword">MOV </span>            <span class="built_in">R0</span>, <span class="built_in">R4</span></span><br><span class="line"><span class="symbol">.text</span>:<span class="number">0001422</span>A <span class="number">19</span> <span class="number">46</span>       <span class="keyword">MOV </span>            <span class="built_in">R1</span>, <span class="built_in">R3</span></span><br><span class="line"><span class="symbol">.text</span>:<span class="number">0001422</span>C <span class="number">2</span>A <span class="number">46</span>       <span class="keyword">MOV </span>            <span class="built_in">R2</span>, <span class="built_in">R5</span></span><br><span class="line"><span class="symbol">.text</span>:<span class="number">0001422</span>E <span class="number">01</span> <span class="built_in">F0</span> <span class="built_in">C7</span> F8 <span class="keyword">BL </span>             <span class="keyword">sub_153C0 </span><span class="comment">; 这里的r4是方法3ec48的返回值，与R0指向同一个地址</span></span><br></pre></td></tr></table></figure></p>
</blockquote>
<blockquote>
<p>总的来说这个方法就是替换空字符和字符’+’为字符’a’，其他的操作没看到有啥太大的影响，具体可以自行调试一行一行的分析<br>接着是最后一点了<br><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">v22 = (<span class="keyword">char</span> *)sub_3E4D4((<span class="keyword">int</span>)&amp;v32);</span><br><span class="line">v43 = getName(serverTime, v22, (<span class="keyword">char</span> *)&amp;unk_598B4);<span class="comment">// v22是拼接后的所有value</span></span><br></pre></td></tr></table></figure></p>
</blockquote>
<blockquote>
<p>这里的v32和上面说的R4、R0的地址是同一个，所以这里的v32就是替换过空字符和’+’的最后的params，然后sub_3E4D4这个方法相当于从v32指向的地址取出字符串，然后就是调用getName加密</p>
</blockquote>
<hr>
<p>先前说了这个参数在添加到map后是排序了的，按字母表顺序，比如如下处理后的参数<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br></pre></td><td class="code"><pre><span class="line">0xc930f36d=======================</span><br><span class="line">[0xc82ff108](0xc9339acc)(0x0) 参数1 &gt;</span><br><span class="line"></span><br><span class="line">[0xc4770604](0xc0a2e96c) 参数2 &gt; 1575269103371</span><br><span class="line"></span><br><span class="line">retval &gt;  0xc82ff108</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">0xc930f36d=======================</span><br><span class="line">[0xc82ff108](0xc1cf2a2c)(0x35373531) 参数1 &gt; 1575269103371</span><br><span class="line"></span><br><span class="line">[0xc4770034](0xc4770044) 参数2 &gt; wifi</span><br><span class="line"></span><br><span class="line">retval &gt;  0xc82ff108</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">0xc930f36d=======================</span><br><span class="line">[0xc82ff108](0xe0d8e2e4)(0x35373531) 参数1 &gt; 1575269103371wifi</span><br><span class="line"></span><br><span class="line">[0xc47700c4](0xc47700d4) 参数2 &gt; 1128</span><br><span class="line"></span><br><span class="line">retval &gt;  0xc82ff108</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">0xc930f36d=======================</span><br><span class="line">[0xc82ff108](0xe0d8e2e4)(0x35373531) 参数1 &gt; 1575269103371wifi1128</span><br><span class="line"></span><br><span class="line">[0xc477010c](0xc47700ec) 参数2 &gt; aweme</span><br><span class="line"></span><br><span class="line">retval &gt;  0xc82ff108</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">0xc930f36d=======================</span><br><span class="line">[0xc82ff108](0xe0d8e2e4)(0x35373531) 参数1 &gt; 1575269103371wifi1128aweme</span><br><span class="line"></span><br><span class="line">[0xc477007c](0xc477005c) 参数2 &gt; wandoujia</span><br><span class="line"></span><br><span class="line">retval &gt;  0xc82ff108</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">0xc930f36d=======================</span><br><span class="line">[0xc82ff108](0xc0aff4cc)(0x35373531) 参数1 &gt; 1575269103371wifi1128awemewandoujia</span><br><span class="line"></span><br><span class="line">[0xc476ff2c](0xc2fbe14c) 参数2 &gt; 6</span><br><span class="line"></span><br><span class="line">retval &gt;  0xc82ff108</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">0xc930f36d=======================</span><br><span class="line">[0xc82ff108](0xc0aff4cc)(0x35373531) 参数1 &gt; 1575269103371wifi1128awemewandoujia6</span><br><span class="line"></span><br><span class="line">[0xc477028c](0xc477026c) 参数2 &gt; Xiaomi</span><br><span class="line"></span><br><span class="line">retval &gt;  0xc82ff108</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">0xc930f36d=======================</span><br><span class="line">[0xc82ff108](0xc0aff4cc)(0x35373531) 参数1 &gt; 1575269103371wifi1128awemewandoujia6Xiaomi</span><br><span class="line"></span><br><span class="line">[0xc477001c](0xc476fffc) 参数2 &gt; 69143529399</span><br><span class="line"></span><br><span class="line">retval &gt;  0xc82ff108</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">0xc930f36d=======================</span><br><span class="line">[0xc82ff108](0xe0dec18c)(0x35373531) 参数1 &gt; 1575269103371wifi1128awemewandoujia6Xiaomi69143529399</span><br><span class="line"></span><br><span class="line">[0xc47701cc](0xc477017c) 参数2 &gt; android</span><br><span class="line"></span><br><span class="line">retval &gt;  0xc82ff108</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">0xc930f36d=======================</span><br><span class="line">[0xc82ff108](0xe0dec18c)(0x35373531) 参数1 &gt; 1575269103371wifi1128awemewandoujia6Xiaomi69143529399android</span><br><span class="line"></span><br><span class="line">[0xc477025c](0xc477023c) 参数2 &gt; MI MAX 3</span><br><span class="line"></span><br><span class="line">retval &gt;  0xc82ff108</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">0xc930f36d=======================</span><br><span class="line">[0xc82ff108](0xe0dec18c)(0x35373531) 参数1 &gt; 1575269103371wifi1128awemewandoujia6Xiaomi69143529399androidMI MAX 3</span><br><span class="line"></span><br><span class="line">[0xc47705bc](0xc2fbe2dc) 参数2 &gt; 440</span><br><span class="line"></span><br><span class="line">retval &gt;  0xc82ff108</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">0xc930f36d=======================</span><br><span class="line">[0xc82ff108](0xe0dec18c)(0x35373531) 参数1 &gt; 1575269103371wifi1128awemewandoujia6Xiaomi69143529399androidMI MAX 3440</span><br><span class="line"></span><br><span class="line">[0xc476ffd4](0xc476ffb4) 参数2 &gt; 88263783316</span><br><span class="line"></span><br><span class="line">retval &gt;  0xc82ff108</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">0xc930f36d=======================</span><br><span class="line">[0xc82ff108](0xe0dec18c)(0x35373531) 参数1 &gt; 1575269103371wifi1128awemewandoujia6Xiaomi69143529399androidMI MAX 344088263783316</span><br><span class="line"></span><br><span class="line">[0xc47702a4](0xc2fbe1bc) 参数2 &gt; zh</span><br><span class="line"></span><br><span class="line">retval &gt;  0xc82ff108</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">0xc930f36d=======================</span><br><span class="line">[0xc82ff108](0xe0dec18c)(0x35373531) 参数1 &gt; 1575269103371wifi1128awemewandoujia6Xiaomi69143529399androidMI MAX 344088263783316zh</span><br><span class="line"></span><br><span class="line">[0xc477055c](0xc2fbe24c) 参数2 &gt; 166</span><br><span class="line"></span><br><span class="line">retval &gt;  0xc82ff108</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">0xc930f36d=======================</span><br><span class="line">[0xc82ff108](0xe0dec18c)(0x35373531) 参数1 &gt; 1575269103371wifi1128awemewandoujia6Xiaomi69143529399androidMI MAX 344088263783316zh166</span><br><span class="line"></span><br><span class="line">[0xc476fee4](0xc2fbe12c) 参数2 &gt; 0</span><br><span class="line"></span><br><span class="line">retval &gt;  0xc82ff108</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">0xc930f36d=======================</span><br><span class="line">[0xc82ff108](0xe0dec18c)(0x35373531) 参数1 &gt; 1575269103371wifi1128awemewandoujia6Xiaomi69143529399androidMI MAX 344088263783316zh1660</span><br><span class="line"></span><br><span class="line">[0xc476ff14](0xc2fbe13c) 参数2 &gt; 0</span><br><span class="line"></span><br><span class="line">retval &gt;  0xc82ff108</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">0xc930f36d=======================</span><br><span class="line">[0xc82ff108](0xe0dec18c)(0x35373531) 参数1 &gt; 1575269103371wifi1128awemewandoujia6Xiaomi69143529399androidMI MAX 344088263783316zh16600</span><br><span class="line"></span><br><span class="line">[0xc4770544](0xc1c9bd6c) 参数2 &gt; ffa82bd3b1106594</span><br><span class="line"></span><br><span class="line">retval &gt;  0xc82ff108</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">0xc930f36d=======================</span><br><span class="line">[0xc82ff108](0xe0dba9ac)(0x35373531) 参数1 &gt; 1575269103371wifi1128awemewandoujia6Xiaomi69143529399androidMI MAX 344088263783316zh16600ffa82bd3b1106594</span><br><span class="line"></span><br><span class="line">[0xc476fe54](0xc2fbe22c) 参数2 &gt; 28</span><br><span class="line"></span><br><span class="line">retval &gt;  0xc82ff108</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">0xc930f36d=======================</span><br><span class="line">[0xc82ff108](0xe0dba9ac)(0x35373531) 参数1 &gt; 1575269103371wifi1128awemewandoujia6Xiaomi69143529399androidMI MAX 344088263783316zh16600ffa82bd3b110659428</span><br><span class="line"></span><br><span class="line">[0xc4770304](0xc2fbe23c) 参数2 &gt; 9</span><br><span class="line"></span><br><span class="line">retval &gt;  0xc82ff108</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">0xc930f36d=======================</span><br><span class="line">[0xc82ff108](0xe0dba9ac)(0x35373531) 参数1 &gt; 1575269103371wifi1128awemewandoujia6Xiaomi69143529399androidMI MAX 344088263783316zh16600ffa82bd3b1106594289</span><br><span class="line"></span><br><span class="line">[0xc47705a4](0xc4770584) 参数2 &gt; 1080*2029</span><br><span class="line"></span><br><span class="line">retval &gt;  0xc82ff108</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">0xc930f36d=======================</span><br><span class="line">[0xc82ff108](0xe0dba9ac)(0x35373531) 参数1 &gt; 1575269103371wifi1128awemewandoujia6Xiaomi69143529399androidMI MAX 344088263783316zh16600ffa82bd3b11065942891080*2029</span><br><span class="line"></span><br><span class="line">[0xc476ff8c](0xc476ff6c) 参数2 &gt; no_retry</span><br><span class="line"></span><br><span class="line">retval &gt;  0xc82ff108</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">0xc930f36d=======================</span><br><span class="line">[0xc82ff108](0xe0dba9ac)(0x35373531) 参数1 &gt; 1575269103371wifi1128awemewandoujia6Xiaomi69143529399androidMI MAX 344088263783316zh16600ffa82bd3b11065942891080*2029no_retry</span><br><span class="line"></span><br><span class="line">[0xc4770664](0xc4770674) 参数2 &gt; efc84c17</span><br><span class="line"></span><br><span class="line">retval &gt;  0xc82ff108</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">0xc930f36d=======================</span><br><span class="line">[0xc82ff108](0xe0dba9ac)(0x35373531) 参数1 &gt; 1575269103371wifi1128awemewandoujia6Xiaomi69143529399androidMI MAX 344088263783316zh16600ffa82bd3b11065942891080*2029no_retryefc84c17</span><br><span class="line"></span><br><span class="line">[0xc4770214](0xc2fbe1ac) 参数2 &gt; a</span><br><span class="line"></span><br><span class="line">retval &gt;  0xc82ff108</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">0xc930f36d=======================</span><br><span class="line">[0xc82ff108](0xe0dba9ac)(0x35373531) 参数1 &gt; 1575269103371wifi1128awemewandoujia6Xiaomi69143529399androidMI MAX 344088263783316zh16600ffa82bd3b11065942891080*2029no_retryefc84c17a</span><br><span class="line"></span><br><span class="line">[0xc4770634](0xc4770614) 参数2 &gt; 1575269102</span><br><span class="line"></span><br><span class="line">retval &gt;  0xc82ff108</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">0xc930f36d=======================</span><br><span class="line">[0xc82ff108](0xe0dba9ac)(0x35373531) 参数1 &gt; 1575269103371wifi1128awemewandoujia6Xiaomi69143529399androidMI MAX 344088263783316zh16600ffa82bd3b11065942891080*2029no_retryefc84c17a1575269102</span><br><span class="line"></span><br><span class="line">[0xc476fe9c](0xc2fbe11c) 参数2 &gt; 0</span><br><span class="line"></span><br><span class="line">retval &gt;  0xc82ff108</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">0xc930f36d=======================</span><br><span class="line">[0xc82ff108](0xe0dba9ac)(0x35373531) 参数1 &gt; 1575269103371wifi1128awemewandoujia6Xiaomi69143529399androidMI MAX 344088263783316zh16600ffa82bd3b11065942891080*2029no_retryefc84c17a15752691020</span><br><span class="line"></span><br><span class="line">[0xc47705d4](0xc476fe7c) 参数2 &gt; 1662</span><br><span class="line"></span><br><span class="line">retval &gt;  0xc82ff108</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">0xc930f36d=======================</span><br><span class="line">[0xc82ff108](0xe0dba9ac)(0x35373531) 参数1 &gt; 1575269103371wifi1128awemewandoujia6Xiaomi69143529399androidMI MAX 344088263783316zh16600ffa82bd3b11065942891080*2029no_retryefc84c17a157526910201662</span><br><span class="line"></span><br><span class="line">[0xc4770514](0xc1c9bd8c) 参数2 &gt; 868695035559432</span><br><span class="line"></span><br><span class="line">retval &gt;  0xc82ff108</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">0xc930f36d=======================</span><br><span class="line">[0xc82ff108](0xe0dba9ac)(0x35373531) 参数1 &gt; 1575269103371wifi1128awemewandoujia6Xiaomi69143529399androidMI MAX 344088263783316zh16600ffa82bd3b11065942891080*2029no_retryefc84c17a157526910201662868695035559432</span><br><span class="line"></span><br><span class="line">[0xc4770124](0xc2fbe19c) 参数2 &gt; 166</span><br><span class="line"></span><br><span class="line">retval &gt;  0xc82ff108</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">0xc930f36d=======================</span><br><span class="line">[0xc82ff108](0xe0dba9ac)(0x35373531) 参数1 &gt; 1575269103371wifi1128awemewandoujia6Xiaomi69143529399androidMI MAX 344088263783316zh16600ffa82bd3b11065942891080*2029no_retryefc84c17a157526910201662868695035559432166</span><br><span class="line"></span><br><span class="line">[0xc477016c](0xc477014c) 参数2 &gt; 1.6.6</span><br><span class="line"></span><br><span class="line">retval &gt;  0xc82ff108</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">0xc930f36d=======================</span><br><span class="line">[0xc82ff108](0xe0dba9ac)(0x35373531) 参数1 &gt; 1575269103371wifi1128awemewandoujia6Xiaomi69143529399androidMI MAX 344088263783316zh16600ffa82bd3b11065942891080*2029no_retryefc84c17a1575269102016628686950355594321661.6.6</span><br><span class="line"></span><br><span class="line">[0xc476fddc](0xc2fbe15c) 参数2 &gt; 0.0</span><br><span class="line"></span><br><span class="line">retval &gt;  0xc82ff108</span><br></pre></td></tr></table></figure></p>
<p>可以得到如下排序<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">_rticket</span><br><span class="line">ac</span><br><span class="line">aid</span><br><span class="line">app_name</span><br><span class="line">channel</span><br><span class="line">count</span><br><span class="line">device_brand</span><br><span class="line">device_id</span><br><span class="line">device_platform</span><br><span class="line">device_type</span><br><span class="line">dpi</span><br><span class="line">iid</span><br><span class="line">language</span><br><span class="line">manifest_version_code</span><br><span class="line">max_cursor</span><br><span class="line">min_cursor</span><br><span class="line">openudid</span><br><span class="line">os_api</span><br><span class="line">os_version</span><br><span class="line">openudid</span><br><span class="line">retry_type</span><br><span class="line">rstr</span><br><span class="line">ssmix</span><br><span class="line">ts</span><br><span class="line">type</span><br><span class="line">update_version_code</span><br><span class="line">uuid</span><br><span class="line">version_code</span><br><span class="line">version_name</span><br><span class="line">volume</span><br></pre></td></tr></table></figure></p>
<p>然后上全部代码<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">shuffle</span><span class="params">(result, array)</span>:</span></span><br><span class="line">    ret = [<span class="string">'0'</span>, <span class="string">'0'</span>, <span class="string">'0'</span>, <span class="string">'0'</span>, <span class="string">'0'</span>, <span class="string">'0'</span>, <span class="string">'0'</span>, <span class="string">'0'</span>]</span><br><span class="line">    ret[<span class="number">2</span>] = result[ord(array[<span class="number">2</span>]) - <span class="number">49</span>]</span><br><span class="line">    ret[<span class="number">4</span>] = result[ord(array[<span class="number">4</span>]) - <span class="number">49</span>]</span><br><span class="line">    ret[<span class="number">6</span>] = result[ord(array[<span class="number">6</span>]) - <span class="number">49</span>]</span><br><span class="line">    ret[<span class="number">5</span>] = result[ord(array[<span class="number">5</span>]) - <span class="number">49</span>]</span><br><span class="line">    ret[<span class="number">3</span>] = result[ord(array[<span class="number">3</span>]) - <span class="number">49</span>]</span><br><span class="line">    ret[<span class="number">1</span>] = result[ord(array[<span class="number">1</span>]) - <span class="number">49</span>]</span><br><span class="line">    ret[<span class="number">7</span>] = result[ord(array[<span class="number">7</span>]) - <span class="number">49</span>]</span><br><span class="line">    ret[<span class="number">0</span>] = result[ord(array[<span class="number">0</span>]) - <span class="number">49</span>]</span><br><span class="line">    <span class="keyword">return</span> <span class="string">''</span>.join(ret)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_name</span><span class="params">(server_time, params)</span>:</span></span><br><span class="line">    _as = [<span class="string">'0'</span>, <span class="string">'0'</span>, <span class="string">'0'</span>, <span class="string">'0'</span>, <span class="string">'0'</span>, <span class="string">'0'</span>, <span class="string">'0'</span>, <span class="string">'0'</span>, <span class="string">'0'</span>, <span class="string">'0'</span>, <span class="string">'0'</span>, <span class="string">'0'</span>, <span class="string">'0'</span>, <span class="string">'0'</span>, <span class="string">'0'</span>, <span class="string">'0'</span>, <span class="string">'0'</span>, <span class="string">'0'</span>]</span><br><span class="line">    _cp = [<span class="string">'0'</span>, <span class="string">'0'</span>, <span class="string">'0'</span>, <span class="string">'0'</span>, <span class="string">'0'</span>, <span class="string">'0'</span>, <span class="string">'0'</span>, <span class="string">'0'</span>, <span class="string">'0'</span>, <span class="string">'0'</span>, <span class="string">'0'</span>, <span class="string">'0'</span>, <span class="string">'0'</span>, <span class="string">'0'</span>, <span class="string">'0'</span>, <span class="string">'0'</span>, <span class="string">'0'</span>, <span class="string">'0'</span>]</span><br><span class="line">    shuffle1 = hex(server_time)[<span class="number">2</span>:]</span><br><span class="line">    shuffle2 = hex(server_time)[<span class="number">2</span>:]</span><br><span class="line">    shuffle1 = shuffle(shuffle1, <span class="string">'57218436'</span>)</span><br><span class="line">    shuffle2 = shuffle(shuffle2, <span class="string">'15387264'</span>)</span><br><span class="line">    params_md5 = hashlib.md5(params.encode(<span class="string">'utf-8'</span>)).hexdigest()</span><br><span class="line">    <span class="keyword">if</span> server_time &amp; <span class="number">1</span>:</span><br><span class="line">        params_md5 = hashlib.md5(params_md5.encode(<span class="string">'utf-8'</span>)).hexdigest()</span><br><span class="line">    _as[<span class="number">0</span>] = chr(<span class="number">97</span>)</span><br><span class="line">    _as[<span class="number">1</span>] = chr(<span class="number">49</span>)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">8</span>):</span><br><span class="line">        _as[<span class="number">2</span>*(i+<span class="number">1</span>)] = params_md5[i]</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> range(<span class="number">8</span>):</span><br><span class="line">        _as[<span class="number">2</span>*j+<span class="number">3</span>] = shuffle2[j]</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> k <span class="keyword">in</span> range(<span class="number">8</span>):</span><br><span class="line">        _cp[<span class="number">2</span>*k] = shuffle1[k]</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> l <span class="keyword">in</span> range(<span class="number">8</span>):</span><br><span class="line">        _cp[<span class="number">2</span>*l+<span class="number">1</span>] = params_md5[l+<span class="number">24</span>]</span><br><span class="line">    </span><br><span class="line">    _cp[<span class="number">16</span>] = chr(<span class="number">101</span>)</span><br><span class="line">    _cp[<span class="number">17</span>] = chr(<span class="number">49</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="string">''</span>.join(_as + _cp)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">params_replace</span><span class="params">(params)</span>:</span></span><br><span class="line">    ret = <span class="string">''</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> list(params):</span><br><span class="line">        <span class="keyword">if</span> ord(i) == <span class="number">32</span> <span class="keyword">or</span> ord(i) == <span class="number">43</span>:</span><br><span class="line">            ret += chr(<span class="number">97</span>)</span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line">        ret += i </span><br><span class="line">    <span class="keyword">return</span> ret</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">p2d</span><span class="params">(p)</span>:</span></span><br><span class="line">    _ = p.split(<span class="string">'&amp;'</span>)</span><br><span class="line">    r = &#123;&#125;</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> _:</span><br><span class="line">        __ = i.split(<span class="string">'='</span>)</span><br><span class="line">        r[__[<span class="number">0</span>]] = __[<span class="number">1</span>]</span><br><span class="line">    r[<span class="string">'rstr'</span>] = <span class="string">'efc84c17'</span></span><br><span class="line">    <span class="keyword">return</span> r</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">params_process</span><span class="params">(params: dict)</span>:</span></span><br><span class="line">    ret = &#123;&#125;</span><br><span class="line">    <span class="keyword">for</span> k,v <span class="keyword">in</span> params.items():</span><br><span class="line">        ret[k] = v</span><br><span class="line">    <span class="comment"># params = p2d(params)</span></span><br><span class="line">    params[<span class="string">'rstr'</span>] = <span class="string">'efc84c17'</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> [<span class="string">'as'</span>, <span class="string">'cp'</span>]:</span><br><span class="line">        <span class="keyword">if</span> i <span class="keyword">in</span> params:</span><br><span class="line">            <span class="keyword">del</span> params[i]</span><br><span class="line">    st = int(params[<span class="string">'_rticket'</span>])</span><br><span class="line">    sorted_k = sorted(params)</span><br><span class="line">    pars = <span class="string">''</span></span><br><span class="line">    <span class="keyword">for</span> k <span class="keyword">in</span> sorted_k:</span><br><span class="line">        pars += params[k]</span><br><span class="line">    print(pars)</span><br><span class="line">    encrypt = get_name(st, params_replace(pars))</span><br><span class="line">    _as = encrypt[:len(encrypt)//<span class="number">2</span>]</span><br><span class="line">    _cp = encrypt[len(encrypt)//<span class="number">2</span>:]</span><br><span class="line">    ret.update(&#123;<span class="string">'as'</span>: _as, <span class="string">'cp'</span>: _cp&#125;)</span><br><span class="line">    <span class="keyword">return</span> ret</span><br><span class="line">    </span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span><span class="params">()</span>:</span></span><br><span class="line">    params = &#123;</span><br><span class="line">        <span class="string">'type'</span>: <span class="string">'0'</span>,  <span class="comment"># 不知道啥玩意儿</span></span><br><span class="line">        <span class="string">'max_cursor'</span>: <span class="string">'0'</span>, <span class="comment"># 不知道啥玩意儿</span></span><br><span class="line">        <span class="string">'min_cursor'</span>: <span class="string">'0'</span>, <span class="comment"># 不知道啥玩意儿</span></span><br><span class="line">        <span class="string">'count'</span>: <span class="string">'6'</span>, <span class="comment"># 个数</span></span><br><span class="line">        <span class="string">'volume'</span>: <span class="string">'0.0'</span>,  <span class="comment"># 不知道啥玩意儿</span></span><br><span class="line">        <span class="string">'retry_type'</span>: <span class="string">'no_retry'</span>,  <span class="comment"># 不知道啥玩意儿</span></span><br><span class="line">        <span class="string">'iid'</span>: <span class="string">'88263783316'</span>,  <span class="comment"># install id，固定即可</span></span><br><span class="line">        <span class="string">'device_id'</span>: <span class="string">'69143529399'</span>,  <span class="comment"># 设备id，固定即可</span></span><br><span class="line">        <span class="string">'ac'</span>: <span class="string">'wifi'</span>,  <span class="comment"># 网络类型</span></span><br><span class="line">        <span class="string">'channel'</span>: <span class="string">'wandoujia'</span>,  <span class="comment"># 安装渠道吧</span></span><br><span class="line">        <span class="string">'aid'</span>: <span class="string">'1128'</span>,  <span class="comment"># 不知道啥玩意儿</span></span><br><span class="line">        <span class="string">'app_name'</span>: <span class="string">'aweme'</span>,  <span class="comment"># appname</span></span><br><span class="line">        <span class="string">'version_code'</span>: <span class="string">'166'</span>,  <span class="comment"># 版本号</span></span><br><span class="line">        <span class="string">'version_name'</span>: <span class="string">'1.6.6'</span>,  <span class="comment"># 版本</span></span><br><span class="line">        <span class="string">'device_platform'</span>: <span class="string">'android'</span>,  <span class="comment"># 设备平台</span></span><br><span class="line">        <span class="string">'ssmix'</span>: <span class="string">'a'</span>,  <span class="comment"># 不知道啥玩意儿</span></span><br><span class="line">        <span class="string">'device_type'</span>: <span class="string">'MI+8+UD'</span>,  <span class="comment"># 设备类型</span></span><br><span class="line">        <span class="string">'device_brand'</span>: <span class="string">'Xiaomi'</span>,  <span class="comment"># 设备品牌</span></span><br><span class="line">        <span class="string">'language'</span>: <span class="string">'zh'</span>,  <span class="comment"># 系统语言</span></span><br><span class="line">        <span class="string">'os_api'</span>: <span class="string">'28'</span>,  <span class="comment"># android 版本号</span></span><br><span class="line">        <span class="string">'os_version'</span>: <span class="string">'9'</span>,  <span class="comment"># android 版本</span></span><br><span class="line">        <span class="string">'uuid'</span>: <span class="string">'868695035559432'</span>,  <span class="comment"># 多半和登陆账号有关</span></span><br><span class="line">        <span class="string">'openudid'</span>: <span class="string">'ffa82bd3b1106594'</span>,  <span class="comment"># 不知道啥玩意儿</span></span><br><span class="line">        <span class="string">'manifest_version_code'</span>: <span class="string">'166'</span>,  <span class="comment"># androidmanifest中的版本号</span></span><br><span class="line">        <span class="string">'resolution'</span>: <span class="string">'1080*2029'</span>,  <span class="comment"># 分辨率</span></span><br><span class="line">        <span class="string">'dpi'</span>: <span class="string">'440'</span>,  <span class="comment"># dpi</span></span><br><span class="line">        <span class="string">'update_version_code'</span>: <span class="string">'1662'</span>,  <span class="comment"># 更新版本号</span></span><br><span class="line">        <span class="string">'_rticket'</span>: str(int(time.time()*<span class="number">1000</span>)),  <span class="comment"># 时间戳</span></span><br><span class="line">        <span class="string">'ts'</span>: str(int(time.time())),  <span class="comment"># 时间戳</span></span><br><span class="line">        <span class="string">'as'</span>: <span class="string">'a185bba996d57d23ba'</span>,  <span class="comment"># 不知道啥玩意儿</span></span><br><span class="line">        <span class="string">'cp'</span>: <span class="string">'b357d1586da49f39e1'</span>  <span class="comment"># 不知道啥玩意儿</span></span><br><span class="line">    &#125;</span><br><span class="line">    params = params_process(params)</span><br><span class="line">    headers = &#123;</span><br><span class="line">        <span class="string">'User-Agent'</span>: <span class="string">'okhttp/3.8.1'</span>,</span><br><span class="line">        <span class="string">'Host'</span>: <span class="string">'aweme-eagle.snssdk.com'</span>,</span><br><span class="line">    &#125;</span><br><span class="line">    resp = requests.get(<span class="string">'https://aweme-eagle.snssdk.com/aweme/v1/feed/'</span>, params=params, headers=headers)</span><br><span class="line">    print(resp.url)</span><br><span class="line">    print(resp.json())</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">"__main__"</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure></p>
<p>然后运行<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">❯ python3 crawl.py</span><br><span class="line">1575271139258wifi1128awemewandoujia6Xiaomi69143529399androidMI+8+UD44088263783316zh16600ffa82bd3b11065942891080*2029no_retryefc84c17a1575271139016628686950355594321661.6.60.0</span><br><span class="line">https://aweme-eagle.snssdk.com/aweme/v1/feed/?type=0&amp;max_cursor=0&amp;min_cursor=0&amp;count=6&amp;volume=0.0&amp;retry_type=no_retry&amp;iid=88263783316&amp;device_id=69143529399&amp;ac=wifi&amp;channel=wandoujia&amp;aid=1128&amp;app_name=aweme&amp;version_code=166&amp;version_name=1.6.6&amp;device_platform=and</span><br><span class="line">roid&amp;ssmix=a&amp;device_type=MI%2B8%2BUD&amp;device_brand=Xiaomi&amp;language=zh&amp;os_api=28&amp;os_version=9&amp;uuid=868695035559432&amp;openudid=ffa82bd3b1106594&amp;manifest_version_code=166&amp;resolution=1080%2A2029&amp;dpi=440&amp;update_version_code=1662&amp;_rticket=1575271139258&amp;ts=1575271139&amp;as=</span><br><span class="line">a1e1757e60dae617ec&amp;cp=5ea262180cc3e37be1</span><br><span class="line">&#123;&apos;status_code&apos;: 2154, &apos;aweme_list&apos;: [], &apos;has_more&apos;: 1, &apos;min_cursor&apos;: 0, &apos;max_cursor&apos;: 0&#125;</span><br></pre></td></tr></table></figure></p>
<p>心里是不是跟吃了shit一样难受；为了搞清楚为什么返回2154，我hook了下java层调用部分来对比：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">String</span>.prototype.format = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> values = <span class="built_in">arguments</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">this</span>.replace(<span class="regexp">/\&#123;(\d+)\&#125;/g</span>, <span class="function"><span class="keyword">function</span> (<span class="params">match, index</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (values.length &gt; index) &#123;</span><br><span class="line">            <span class="keyword">return</span> values[index];</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="string">""</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// Memory.readUtf8String</span></span><br><span class="line"><span class="keyword">var</span> mru8s = <span class="function"><span class="keyword">function</span>(<span class="params">addr</span>) </span>&#123;<span class="keyword">return</span> Memory.readUtf8String(addr)&#125;</span><br><span class="line"><span class="comment">// Memory.readPointer</span></span><br><span class="line"><span class="keyword">var</span> mrp = <span class="function"><span class="keyword">function</span>(<span class="params">addr</span>) </span>&#123;<span class="keyword">return</span> Memory.readPointer(addr)&#125;</span><br><span class="line"><span class="comment">// Memory.allocUtf8String</span></span><br><span class="line"><span class="keyword">var</span> mau8s = <span class="function"><span class="keyword">function</span>(<span class="params">addr</span>) </span>&#123;<span class="keyword">return</span> Memory.allocUtf8String(addr)&#125;</span><br><span class="line"><span class="comment">// read process memory</span></span><br><span class="line"><span class="keyword">var</span> rpm = <span class="function"><span class="keyword">function</span>(<span class="params">addr, size</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> buf = Memory.readByteArray(ptr(<span class="string">'0x'</span> + addr), size);</span><br><span class="line">    <span class="built_in">console</span>.log(hexdump(buf, &#123;</span><br><span class="line">    offset: <span class="number">0</span>,</span><br><span class="line">        length: size,</span><br><span class="line">        header: <span class="literal">true</span>,</span><br><span class="line">        ansi: <span class="literal">false</span></span><br><span class="line">    &#125;));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//==================================================================</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> JNI_OnLoad;</span><br><span class="line"><span class="keyword">var</span> exports = Module.enumerateExportsSync(<span class="string">"libuserinfo.so"</span>);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; exports.length; i++) &#123;</span><br><span class="line">    <span class="keyword">var</span> name = exports[i].name;</span><br><span class="line">    <span class="keyword">var</span> addr = exports[i].address;</span><br><span class="line">    <span class="keyword">if</span> (name == <span class="string">'JNI_OnLoad'</span>) &#123;</span><br><span class="line">        JNI_OnLoad = addr;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> BASE_ADDR = <span class="built_in">parseInt</span>(JNI_OnLoad) - <span class="built_in">parseInt</span>(<span class="string">"0x14504"</span>);</span><br><span class="line"><span class="keyword">var</span> addr = <span class="string">'0x'</span> + <span class="built_in">parseInt</span>(BASE_ADDR + <span class="built_in">parseInt</span>(<span class="string">'0x11828'</span>)).toString(<span class="number">16</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> i = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">Interceptor.attach(<span class="keyword">new</span> NativePointer(addr), &#123;</span><br><span class="line">    onEnter: <span class="function"><span class="keyword">function</span>(<span class="params">args</span>) </span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">'&#123;0&#125;======================='</span>.format(addr));</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">'[&#123;0&#125;] 参数1 &gt; &#123;1&#125;\n'</span>.format(args[<span class="number">0</span>], args[<span class="number">0</span>].toInt32()));</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">'[&#123;0&#125;] 参数2 &gt; &#123;1&#125;\n'</span>.format(args[<span class="number">1</span>], mru8s(args[<span class="number">1</span>])));</span><br><span class="line">    &#125;,</span><br><span class="line">    onLeave: <span class="function"><span class="keyword">function</span>(<span class="params">retval</span>) </span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">'retval &gt; '</span>, mru8s(retval));</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">'\n'</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">Java.perform(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> UserInfo = Java.use(<span class="string">"com.ss.android.common.applog.UserInfo"</span>);</span><br><span class="line">    UserInfo.getUserInfo.implementation = <span class="function"><span class="keyword">function</span>(<span class="params">arg0, arg1, arg2</span>) </span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">'==================================='</span>);</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">"arg0 &gt; "</span>, arg0);</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">"arg1 &gt; "</span>, arg1);</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">"arg2 &gt; "</span>, arg2);</span><br><span class="line">        <span class="keyword">var</span> retval = <span class="keyword">this</span>.getUserInfo(arg0, arg1, arg2);</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">"retval &gt; "</span>, retval);</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">'\n'</span>);</span><br><span class="line">        <span class="keyword">return</span> retval;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>期间分析了很多地方，然后我突然想通了，我干嘛瞎分析这些玩意儿，直接抓包hook套用不就完事了，只需要改时间戳就行了，所以有了下面的代码；（<strong><code>其实上面没有返回数据是因为params和加密用到的参数不一致</code></strong>）<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">shuffle</span><span class="params">(result, array)</span>:</span></span><br><span class="line">    ret = [<span class="string">'0'</span>, <span class="string">'0'</span>, <span class="string">'0'</span>, <span class="string">'0'</span>, <span class="string">'0'</span>, <span class="string">'0'</span>, <span class="string">'0'</span>, <span class="string">'0'</span>]</span><br><span class="line">    ret[<span class="number">2</span>] = result[ord(array[<span class="number">2</span>]) - <span class="number">49</span>]</span><br><span class="line">    ret[<span class="number">4</span>] = result[ord(array[<span class="number">4</span>]) - <span class="number">49</span>]</span><br><span class="line">    ret[<span class="number">6</span>] = result[ord(array[<span class="number">6</span>]) - <span class="number">49</span>]</span><br><span class="line">    ret[<span class="number">5</span>] = result[ord(array[<span class="number">5</span>]) - <span class="number">49</span>]</span><br><span class="line">    ret[<span class="number">3</span>] = result[ord(array[<span class="number">3</span>]) - <span class="number">49</span>]</span><br><span class="line">    ret[<span class="number">1</span>] = result[ord(array[<span class="number">1</span>]) - <span class="number">49</span>]</span><br><span class="line">    ret[<span class="number">7</span>] = result[ord(array[<span class="number">7</span>]) - <span class="number">49</span>]</span><br><span class="line">    ret[<span class="number">0</span>] = result[ord(array[<span class="number">0</span>]) - <span class="number">49</span>]</span><br><span class="line">    <span class="keyword">return</span> <span class="string">''</span>.join(ret)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_name</span><span class="params">(server_time, params)</span>:</span></span><br><span class="line">    _as = [<span class="string">'0'</span>, <span class="string">'0'</span>, <span class="string">'0'</span>, <span class="string">'0'</span>, <span class="string">'0'</span>, <span class="string">'0'</span>, <span class="string">'0'</span>, <span class="string">'0'</span>, <span class="string">'0'</span>, <span class="string">'0'</span>, <span class="string">'0'</span>, <span class="string">'0'</span>, <span class="string">'0'</span>, <span class="string">'0'</span>, <span class="string">'0'</span>, <span class="string">'0'</span>, <span class="string">'0'</span>, <span class="string">'0'</span>]</span><br><span class="line">    _cp = [<span class="string">'0'</span>, <span class="string">'0'</span>, <span class="string">'0'</span>, <span class="string">'0'</span>, <span class="string">'0'</span>, <span class="string">'0'</span>, <span class="string">'0'</span>, <span class="string">'0'</span>, <span class="string">'0'</span>, <span class="string">'0'</span>, <span class="string">'0'</span>, <span class="string">'0'</span>, <span class="string">'0'</span>, <span class="string">'0'</span>, <span class="string">'0'</span>, <span class="string">'0'</span>, <span class="string">'0'</span>, <span class="string">'0'</span>]</span><br><span class="line">    shuffle1 = hex(server_time)[<span class="number">2</span>:]</span><br><span class="line">    shuffle2 = hex(server_time)[<span class="number">2</span>:]</span><br><span class="line">    shuffle1 = shuffle(shuffle1, <span class="string">'57218436'</span>)</span><br><span class="line">    shuffle2 = shuffle(shuffle2, <span class="string">'15387264'</span>)</span><br><span class="line">    params_md5 = hashlib.md5(params.encode(<span class="string">'utf-8'</span>)).hexdigest()</span><br><span class="line">    <span class="keyword">if</span> server_time &amp; <span class="number">1</span>:</span><br><span class="line">        params_md5 = hashlib.md5(params_md5.encode(<span class="string">'utf-8'</span>)).hexdigest()</span><br><span class="line">    _as[<span class="number">0</span>] = chr(<span class="number">97</span>)</span><br><span class="line">    _as[<span class="number">1</span>] = chr(<span class="number">49</span>)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">8</span>):</span><br><span class="line">        _as[<span class="number">2</span>*(i+<span class="number">1</span>)] = params_md5[i]</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> range(<span class="number">8</span>):</span><br><span class="line">        _as[<span class="number">2</span>*j+<span class="number">3</span>] = shuffle2[j]</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> k <span class="keyword">in</span> range(<span class="number">8</span>):</span><br><span class="line">        _cp[<span class="number">2</span>*k] = shuffle1[k]</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> l <span class="keyword">in</span> range(<span class="number">8</span>):</span><br><span class="line">        _cp[<span class="number">2</span>*l+<span class="number">1</span>] = params_md5[l+<span class="number">24</span>]</span><br><span class="line">    </span><br><span class="line">    _cp[<span class="number">16</span>] = chr(<span class="number">101</span>)</span><br><span class="line">    _cp[<span class="number">17</span>] = chr(<span class="number">49</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="string">''</span>.join(_as + _cp)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">params_replace</span><span class="params">(params)</span>:</span></span><br><span class="line">    ret = <span class="string">''</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> list(params):</span><br><span class="line">        <span class="keyword">if</span> ord(i) == <span class="number">32</span> <span class="keyword">or</span> ord(i) == <span class="number">43</span>:</span><br><span class="line">            ret += chr(<span class="number">97</span>)</span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line">        ret += i </span><br><span class="line">    <span class="keyword">return</span> ret</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">p2d</span><span class="params">(p)</span>:</span></span><br><span class="line">    _ = p.split(<span class="string">'&amp;'</span>)</span><br><span class="line">    r = &#123;&#125;</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> _:</span><br><span class="line">        __ = i.split(<span class="string">'='</span>)</span><br><span class="line">        r[__[<span class="number">0</span>]] = __[<span class="number">1</span>]</span><br><span class="line">    r[<span class="string">'rstr'</span>] = <span class="string">'efc84c17'</span></span><br><span class="line">    <span class="keyword">return</span> r</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">params_process</span><span class="params">(p1)</span>:</span></span><br><span class="line">    ts = p1[<span class="string">'ts'</span>]</span><br><span class="line">    ps = [p1[<span class="string">'_rticket'</span>], <span class="string">'wifi'</span>,<span class="string">'1128'</span>,<span class="string">'aweme'</span>,<span class="string">'wandoujia'</span>,<span class="string">'6'</span>,<span class="string">'unknown'</span>,<span class="string">'69143529399'</span>,<span class="string">'android'</span>,<span class="string">'unknown'</span>,<span class="string">'440'</span>,<span class="string">'88263783316'</span>,<span class="string">'zh'</span>,<span class="string">'166'</span>,<span class="string">'0'</span>,<span class="string">'0'</span>,<span class="string">'ffa82bd3b1106594'</span>,<span class="string">'28'</span>,<span class="string">'9'</span>,<span class="string">'1080*2029'</span>,<span class="string">'no_retry'</span>,<span class="string">'efc84c17'</span>,<span class="string">'a'</span>,ts,<span class="string">'0'</span>,<span class="string">'1662'</span>,<span class="string">'166'</span>,<span class="string">'1.6.6'</span>,<span class="string">'0.13333333333333333'</span>]</span><br><span class="line">    encrypt = get_name(int(ts), <span class="string">''</span>.join(ps))</span><br><span class="line">    _as = encrypt[:len(encrypt)//<span class="number">2</span>]</span><br><span class="line">    _cp = encrypt[len(encrypt)//<span class="number">2</span>:]</span><br><span class="line">    p1.update(&#123;<span class="string">'as'</span>: _as, <span class="string">'cp'</span>: _cp&#125;)</span><br><span class="line">    print(encrypt)</span><br><span class="line">    print(p1)</span><br><span class="line">    </span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span><span class="params">()</span>:</span></span><br><span class="line">    _ts = str(int(time.time()))</span><br><span class="line">    _rticket = str(int(time.time()*<span class="number">1000</span>))</span><br><span class="line">    </span><br><span class="line">    p1 = &#123;<span class="string">'type'</span>: <span class="string">'0'</span>,</span><br><span class="line">        <span class="string">'max_cursor'</span>: <span class="string">'0'</span>,</span><br><span class="line">        <span class="string">'min_cursor'</span>: <span class="string">'0'</span>,</span><br><span class="line">        <span class="string">'count'</span>: <span class="string">'6'</span>,</span><br><span class="line">        <span class="string">'volume'</span>: <span class="string">'0.13333333333333333'</span>,</span><br><span class="line">        <span class="string">'retry_type'</span>: <span class="string">'no_retry'</span>,</span><br><span class="line">        <span class="string">'iid'</span>: <span class="string">'88263783316'</span>,</span><br><span class="line">        <span class="string">'device_id'</span>: <span class="string">'69143529399'</span>,</span><br><span class="line">        <span class="string">'ac'</span>: <span class="string">'wifi'</span>,</span><br><span class="line">        <span class="string">'channel'</span>: <span class="string">'wandoujia'</span>,</span><br><span class="line">        <span class="string">'aid'</span>: <span class="string">'1128'</span>,</span><br><span class="line">        <span class="string">'app_name'</span>: <span class="string">'aweme'</span>,</span><br><span class="line">        <span class="string">'version_code'</span>: <span class="string">'166'</span>,</span><br><span class="line">        <span class="string">'version_name'</span>: <span class="string">'1.6.6'</span>,</span><br><span class="line">        <span class="string">'device_platform'</span>: <span class="string">'android'</span>,</span><br><span class="line">        <span class="string">'ssmix'</span>: <span class="string">'a'</span>,</span><br><span class="line">        <span class="string">'device_type'</span>: <span class="string">'unknown'</span>,</span><br><span class="line">        <span class="string">'device_brand'</span>: <span class="string">'unknown'</span>,</span><br><span class="line">        <span class="string">'language'</span>: <span class="string">'zh'</span>,</span><br><span class="line">        <span class="string">'os_api'</span>: <span class="string">'28'</span>,</span><br><span class="line">        <span class="string">'os_version'</span>: <span class="string">'9'</span>,</span><br><span class="line">        <span class="string">'openudid'</span>: <span class="string">'ffa82bd3b1106594'</span>,</span><br><span class="line">        <span class="string">'manifest_version_code'</span>: <span class="string">'166'</span>,</span><br><span class="line">        <span class="string">'resolution'</span>: <span class="string">'1080*2029'</span>,</span><br><span class="line">        <span class="string">'dpi'</span>: <span class="string">'440'</span>,</span><br><span class="line">        <span class="string">'update_version_code'</span>: <span class="string">'1662'</span>,</span><br><span class="line">        <span class="string">'_rticket'</span>: _rticket,</span><br><span class="line">        <span class="string">'ts'</span>: _ts&#125;</span><br><span class="line">    params_process(p1)</span><br><span class="line">    headers = &#123;</span><br><span class="line">        <span class="string">'User-Agent'</span>: <span class="string">'okhttp/3.8.1'</span>,</span><br><span class="line">        <span class="string">'Host'</span>: <span class="string">'aweme-eagle.snssdk.com'</span>,</span><br><span class="line">    &#125;</span><br><span class="line">    resp = requests.get(<span class="string">'https://aweme-eagle.snssdk.com/aweme/v1/feed/'</span>, params=p1, headers=headers)</span><br><span class="line">    print(resp.url)</span><br><span class="line">    print(resp.json())</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">"__main__"</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure></p>
<p>然后运行，输出，完美<br><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">❯ python3 crawl.py</span><br><span class="line">a195132ebd4f4da9453cfbda55d05de699e1</span><br><span class="line">&#123;'type': '0', 'max_cursor': '0', 'min_cursor': '0', 'count': '6', 'volume': '0.13333333333333333', 'retry_type': 'no_retry', 'iid': '88263783316', 'device_id': '69143529399', 'ac': 'wifi', 'channel': 'wandoujia', 'aid': '1128', 'app_name': 'aweme', 'version_code': '166', 'version_name': '1.6.6', 'device_platform': 'android', 'ssmix': 'a', 'device_type': 'unknown', 'device_brand': 'unknown', 'language': 'zh', 'os_api': '28', 'os_version': '9', 'openudid': 'ffa82bd3b1106594', 'manifest_version_code': '166', 'resolution': '1080*2029', 'dpi': '440', 'update_version_code': '1662', '_rticket': '1575303677770', 'ts': '1575303677', 'as': 'a195132ebd4f4da945', 'cp': '3cfbda55d05de699e1'&#125;</span><br><span class="line">https://aweme-eagle.snssdk.com/aweme/v1/feed/?type=0&amp;max_cursor=0&amp;min_cursor=0&amp;count=6&amp;volume=0.13333333333333333&amp;retry_type=no_retry&amp;iid=88263783316&amp;device_id=69143529399&amp;ac=wifi&amp;channel=wandoujia&amp;aid=1128&amp;app_name=aweme&amp;version_code=166&amp;version_name=1.6.6&amp;device_platform=android&amp;ssmix=a&amp;device_type=unknown&amp;device_brand=unknown&amp;language=zh&amp;os_api=28&amp;os_version=9&amp;openudid=ffa82bd3b1106594&amp;manifest_version_code=166&amp;resolution=1080%2A2029&amp;dpi=440&amp;update_version_code=1662&amp;_rticket=1575303677770&amp;ts=1575303677&amp;as=a195132ebd4f4da945&amp;cp=3cfbda55d05de699e1</span><br><span class="line">&#123;'status_code': 0, 'min_cursor': 0, 'max_cursor': 0, 'has_more': 1, 'aweme_list': [&#123;'aweme_id': '6765856409071521032', 'desc': '#德阳#特警#在行动', 'create_time': 1575298748, 'author': &#123;'uid': '1780829966313438', 'short_id': '2172980371', 'nickname': '德阳晚报', 'gender': 1, 'signature': '让新闻触动心灵', ...</span><br></pre></td></tr></table></figure></p>
<hr>
<h2 id="最后"><a href="#最后" class="headerlink" title="最后"></a>最后</h2><p>所有脚本、ida文件、jeb文件，以及最后的爬虫脚本都在这：<a href="https://github.com/ZCKun/5a6J5Y2T5oqW6Z-z55-t6KeG6aKRdjE-" target="_blank" rel="noopener">5a6J5Y2T5oqW6Z+z55+t6KeG6aKRdjE=</a></p>
<ul>
<li>email: <a href="mailto:zckuna@163.com" target="_blank" rel="noopener">zckuna@163.com</a></li>
<li>qq: 47439134</li>
</ul>

  </div>
</article>



        
          <div id="footer-post-container">
  <div id="footer-post">

    <div id="nav-footer" style="display: none">
      <ul>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="/about/">About</a></li>
         
          <li><a href="/archives/">Writing</a></li>
         
          <li><a href="/projects_url">Projects</a></li>
        
      </ul>
    </div>

    <div id="toc-footer" style="display: none">
      <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#正文"><span class="toc-number">1.</span> <span class="toc-text">正文</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#IDA调试"><span class="toc-number">2.</span> <span class="toc-text">IDA调试</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#最后"><span class="toc-number">3.</span> <span class="toc-text">最后</span></a></li></ol>
    </div>

    <div id="share-footer" style="display: none">
      <ul>
  <li><a class="icon" href="http://www.facebook.com/sharer.php?u=http://zckun.github.io/2019/12/03/dy-end-191203/"><i class="fab fa-facebook fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://twitter.com/share?url=http://zckun.github.io/2019/12/03/dy-end-191203/&text=5a6J5Y2T5oqW6Z+z55+t6KeG6aKRdjHlroznu5M="><i class="fab fa-twitter fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.linkedin.com/shareArticle?url=http://zckun.github.io/2019/12/03/dy-end-191203/&title=5a6J5Y2T5oqW6Z+z55+t6KeG6aKRdjHlroznu5M="><i class="fab fa-linkedin fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=http://zckun.github.io/2019/12/03/dy-end-191203/&is_video=false&description=5a6J5Y2T5oqW6Z+z55+t6KeG6aKRdjHlroznu5M="><i class="fab fa-pinterest fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=5a6J5Y2T5oqW6Z+z55+t6KeG6aKRdjHlroznu5M=&body=Check out this article: http://zckun.github.io/2019/12/03/dy-end-191203/"><i class="fas fa-envelope fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://getpocket.com/save?url=http://zckun.github.io/2019/12/03/dy-end-191203/&title=5a6J5Y2T5oqW6Z+z55+t6KeG6aKRdjHlroznu5M="><i class="fab fa-get-pocket fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://reddit.com/submit?url=http://zckun.github.io/2019/12/03/dy-end-191203/&title=5a6J5Y2T5oqW6Z+z55+t6KeG6aKRdjHlroznu5M="><i class="fab fa-reddit fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.stumbleupon.com/submit?url=http://zckun.github.io/2019/12/03/dy-end-191203/&title=5a6J5Y2T5oqW6Z+z55+t6KeG6aKRdjHlroznu5M="><i class="fab fa-stumbleupon fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://digg.com/submit?url=http://zckun.github.io/2019/12/03/dy-end-191203/&title=5a6J5Y2T5oqW6Z+z55+t6KeG6aKRdjHlroznu5M="><i class="fab fa-digg fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.tumblr.com/share/link?url=http://zckun.github.io/2019/12/03/dy-end-191203/&name=5a6J5Y2T5oqW6Z+z55+t6KeG6aKRdjHlroznu5M=&description="><i class="fab fa-tumblr fa-lg" aria-hidden="true"></i></a></li>
</ul>

    </div>

    <div id="actions-footer">
        <a id="menu" class="icon" href="#" onclick="$('#nav-footer').toggle();return false;"><i class="fas fa-bars fa-lg" aria-hidden="true"></i> Menu</a>
        <a id="toc" class="icon" href="#" onclick="$('#toc-footer').toggle();return false;"><i class="fas fa-list fa-lg" aria-hidden="true"></i> TOC</a>
        <a id="share" class="icon" href="#" onclick="$('#share-footer').toggle();return false;"><i class="fas fa-share-alt fa-lg" aria-hidden="true"></i> Share</a>
        <a id="top" style="display:none" class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fas fa-chevron-up fa-lg" aria-hidden="true"></i> Top</a>
    </div>

  </div>
</div>

        
        <footer id="footer">
  <div class="footer-left">
    Copyright &copy; 2019 0x2h
  </div>
  <div class="footer-right">
    <nav>
      <ul>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="/about/">About</a></li>
         
          <li><a href="/archives/">Writing</a></li>
         
          <li><a href="/projects_url">Projects</a></li>
        
      </ul>
    </nav>
  </div>
</footer>

    </div>
    <!-- styles -->
<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">
<link rel="stylesheet" href="/lib/justified-gallery/css/justifiedGallery.min.css">

    <!-- jquery -->
<script src="/lib/jquery/jquery.min.js"></script>
<script src="/lib/justified-gallery/js/jquery.justifiedGallery.min.js"></script>
<!-- clipboard -->

  <script src="/lib/clipboard/clipboard.min.js"></script>
  <script type="text/javascript">
  $(function() {
    // copy-btn HTML
    var btn = "<span class=\"btn-copy tooltipped tooltipped-sw\" aria-label=\"Copy to clipboard!\">";
    btn += '<i class="far fa-clone"></i>';
    btn += '</span>'; 
    // mount it!
    $(".highlight .code pre").before(btn);
    var clip = new ClipboardJS('.btn-copy', {
      target: function(trigger) {
        return trigger.nextElementSibling;
      }
    });
    clip.on('success', function(e) {
      e.trigger.setAttribute('aria-label', "Copied!");
      e.clearSelection();
    })
  })
  </script>

<script src="/js/main.js"></script>
<!-- search -->

<!-- Google Analytics -->

<!-- Baidu Analytics -->

    <script type="text/javascript">
        var _hmt = _hmt || [];
        (function() {
            var hm = document.createElement("script");
            hm.src = "https://hm.baidu.com/hm.js?b1bcce32f51ad876ecf02282881e609b";
            var s = document.getElementsByTagName("script")[0];
            s.parentNode.insertBefore(hm, s);
        })();
    </script>

<!-- Disqus Comments -->


</body>
</html>
